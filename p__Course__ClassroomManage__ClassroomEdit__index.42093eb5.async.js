"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[411],{17880:function(ve,A,e){e.r(A);var y=e(97983),m=e.n(y),Z=e(40794),U=e.n(Z),b=e(11281),o=e.n(b),S=e(12812),V=e.n(S),$=e(12741),E=e.n($),z=e(95855),G=e(10703),v=e(47745),H=e(736),N=e(97072),J=e(25641),Q=e(35991),X=e(99644),x=e(2641),C=e(95239),M=e(12461),Y=e(71230),k=e(15746),w=e(26713),q=e(81961),ee=e(71577),ne=e(56318),se=e(96486),Me=e.n(se),i=e(67294),a=e(63154),_e=e(99659),P=e(13714),te=e(26859),I=e(82061),re=e(29141),oe=e(29158),f=e(93637),n=e(85893),ae=function(){var g=(0,x.useParams)(),p=g.classroomId,B=g.courseId,D=p==="0"||!p,ue=(0,i.useState)({}),R=E()(ue,2),s=R[0],u=R[1],le=(0,i.useState)(!1),F=E()(le,2),j=F[0],h=F[1],de=C.Z.useForm(),ie=E()(de,1),O=ie[0],T=(0,_e.Z)(P.se,{manual:!0}),L=T.data,Be=L===void 0?{}:L,je=T.run,ce=(0,x.useSearchParams)(),me=E()(ce,1),W=me[0],Ee=function(_,r){(0,a.Wi)(_).then(function(c){console.log(c),O.setFieldsValue(V()({},r,[Object.assign(_,{url:"https://ssl.cdn.maodouketang.com/".concat(c.key)})]))})},K,Pe=function(_,r){u({percent:0,_status:"active",url:""}),h(!0),K=(0,a._h)(_);var c=K.subscribe({error:function(d){console.log(d)},complete:function(d){u(o()(o()({},s),{},{percent:100,_status:"success",url:"https://ssl.cdn.maodouketang.com/".concat(d.key)})),M.ZP.success("\u4E0A\u4F20\u6210\u529F")},next:function(d){var Oe=d.total.percent.toFixed(0);u(o()(o()({},s),{},{url:"",percent:Oe,_status:"active"}))}});f.U.on("unsubscribe",function(){return c.unsubscribe()})},pe=function(){var t=U()(m()().mark(function _(r){return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:(D?(0,P._I)(o()(o()({courseId:W.get("courseId"),roomId:W.get("roomId")},r),{},{coverUrl:r.coverUrl[0].url,choseUrl:s.url})):(0,P.$H)(o()(o()({},r),{},{coverUrl:r.coverUrl[0].url,choseUrl:s.url||""}))).then(function(d){M.ZP.success("".concat(D?"\u65B0\u589E":"\u7F16\u8F91","\u8BFE\u5802\u6210\u529F")),history.back()});case 1:case"end":return l.stop()}},_)}));return function(r){return t.apply(this,arguments)}}(),De=function(){s.url?(h(!1),u({})):(f.U.emit("unsubscribe"),u(o()(o()({},s),{},{_status:"cancel",url:"-"})))},he=function(_){j&&s._status==="active"&&(M.ZP.warn("\u6B63\u5728\u4E0A\u4F20"),_.stopPropagation(),_.nativeEvent.stopImmediatePropagation())};return(0,i.useEffect)(function(){D||(0,P.se)(p).then(function(t){O.setFieldsValue(t),u(o()(o()({},s),{},{url:t.choseUrl}))})},[p]),(0,i.useEffect)(function(){O.setFieldValue("courseId",B)},[B]),(0,i.useEffect)(function(){return function(){f.U.emit("unsubscribe")}},[]),(0,n.jsx)(z._z,{header:{title:"".concat(D?"\u65B0\u5EFA":"\u7F16\u8F91","\u8BFE\u5802"),onBack:function(){return history.back()}},style:{paddingBottom:"100px"},content:"\u8BFE\u7A0B\u53F7\uFF1A".concat(B),children:(0,n.jsxs)(G.A,{form:O,onFinish:pe,layout:"horizontal",labelCol:{span:4},wrapperCol:{span:8},submitter:{render:function(_,r){return(0,n.jsx)(Y.Z,{children:(0,n.jsx)(k.Z,{span:14,offset:4,children:(0,n.jsx)(w.Z,{children:r})})})}},onReset:function(_){h(!1),u({})},children:[(0,n.jsx)(v.Z,{name:"className",label:"\u8BFE\u5802\u540D\u79F0",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:a.n0}),(0,n.jsx)(v.Z,{name:"courseId",label:"\u8BFE\u7A0B\u53F7",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:a.n0}),(0,n.jsx)(H.Z,{name:"coverUrl",label:"\u5C01\u9762\u56FE",max:1,fieldProps:{name:"file",listType:"picture-card"},colProps:{md:24,xl:12},action:function(_){return Ee(_,"coverUrl")},extra:"\u5EFA\u8BAE\u56FE\u7247\u6BD4\u4F8B\u4E3A16:9"}),(0,n.jsxs)(N.Z,{name:"choseUrl",label:"\u8BFE\u7A0B\u89C6\u9891",colProps:{md:24,xl:12},children:[(0,n.jsx)(q.Z,{maxCount:1,fileList:[],action:function(_){return Pe(_,"choseUrl")},children:(0,n.jsx)(ee.Z,{onClick:he,icon:(0,n.jsx)(te.Z,{}),children:"\u4E0A\u4F20"})}),j&&(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"360px"},children:[(0,n.jsx)(ne.Z,{percent:s.percent,status:s._status}),(0,n.jsx)("a",{style:{width:"80px",marginLeft:"10px"},onClick:De,children:s.url?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I.Z,{style:{marginRight:"3px"}}),"\u6E05\u7A7A"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(re.Z,{style:{marginRight:"3px"}})," \u53D6\u6D88"]})})]}),!s.url&&s._status==="active"&&(0,n.jsx)("span",{children:"\u6B63\u5728\u4E0A\u4F20"}),!!s.url&&s.url!=="-"&&(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"400px",gap:"30px",marginTop:"10px"},children:[(0,n.jsxs)("a",{href:s.url,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},target:"_blank",rel:"noreferrer",children:[(0,n.jsx)(oe.Z,{style:{marginRight:"10px"}}),s.url]}),!j&&(0,n.jsxs)("a",{style:{width:"150px"},onClick:function(){h(!1),u({}),console.log(s)},children:[(0,n.jsx)(I.Z,{style:{marginRight:"3px"}}),"\u6E05\u7A7A"]})]})]}),(0,n.jsx)(J.Z,{name:"type",label:"\u8BFE\u5802\u7C7B\u578B",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:a.n0,request:U()(m()().mark(function t(){return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",[{label:"\u4E92\u52A8\u76F4\u64AD\u8BFE",value:2},{label:"\u89C6\u5C4F\u4E0A\u4F20\u8BFE",value:1}]);case 1:case"end":return r.stop()}},t)}))}),(0,n.jsx)(v.Z,{name:"location",label:"\u4E0A\u8BFE\u5730\u70B9",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:a.n0}),(0,n.jsx)(Q.Z,{name:"startAt",label:"\u4E0A\u8BFE\u65F6\u95F4",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:a.n0,fieldProps:{style:{width:"100%"}}}),(0,n.jsx)(X.Z,{name:"remark",label:"\u5907\u6CE8",colProps:{md:24,xl:24},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:a.n0}),(0,n.jsx)(C.Z.Item,{name:"id",noStyle:!0})]})})};A.default=ae}}]);

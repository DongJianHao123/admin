(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[991],{71694:function(Ke,Te,r){"use strict";r.d(Te,{Z:function(){return y}});var Be=r(11281),ue=r.n(Be),te=r(99399),g=r.n(te),i=r(97983),N=r.n(i),I=r(40794),ne=r.n(I),Z=r(67294),ye=r(12461),j=r(63154),R=r(71167),be=r.n(R),Ee=r(9128),de=r.n(Ee),S=function(d){for(var u=d.split(","),m=u[0].match(/:(.\*?);/)[1],O=atob(u[1]),x=O.length,X=new Uint8Array(x);x--;)X[x]=O.charCodeAt(x);return new Blob([X],{type:m})},D=function(d){for(var u=atob(d),m=[],O=0;O<u.length;O+=512){for(var x=u.slice(O,O+512),X=new Array(x.length),fe=0;fe<x.length;fe++)X[fe]=x.charCodeAt(fe);var Ce=new Uint8Array(X);m.push(Ce)}var $e=new File(m,"upload.jpg",{type:"image/jpeg"});return $e},t=function(d){var u=/<[^>]+>/g;return u.test(d)},n=r(85893);R.Quill.register("modules/imageResize",de());var H=/<img [^>]*src=['"]data:image([^'"]+)[^>]*>/,v={HTML:"text/html",TEXT:"text/plain",IMAGE:"image"},J=function(d){var u=(0,Z.useRef)(null),m=function(){var U=ne()(N()().mark(function h(){var p;return N()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:p=document.createElement("input"),p.setAttribute("type","file"),p.setAttribute("accept","image/*"),p.click(),p.onchange=ne()(N()().mark(function C(){var e;return N()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:e=p.files[0],x(e);case 2:case"end":return B.stop()}},C)}));case 5:case"end":return f.stop()}},h)}));return function(){return U.apply(this,arguments)}}(),O=function(){var U=ne()(N()().mark(function h(p){var w,f,C;return N()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return w=ye.ZP.loading("\u56FE\u7247\u4E0A\u4F20\u4E2D...",0),b.prev=1,b.next=4,(0,j.Wi)(p);case 4:return f=b.sent,w(),C="https://ssl.cdn.maodouketang.com/".concat(f.key),b.abrupt("return",C);case 10:b.prev=10,b.t0=b.catch(1),w(),ye.ZP.error("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 14:case"end":return b.stop()}},h,null,[[1,10]])}));return function(p){return U.apply(this,arguments)}}(),x=function(){var U=ne()(N()().mark(function h(p){var w,f,C,e;return N()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,O(p);case 2:f=B.sent,C=u==null||(w=u.current)===null||w===void 0?void 0:w.getEditor(),e=C.getSelection().index,C.insertEmbed(e,"image",f),C.setSelection(e+1);case 7:case"end":return B.stop()}},h)}));return function(p){return U.apply(this,arguments)}}(),X=(0,Z.useMemo)(function(){return{toolbar:{container:[["bold","italic","underline","strike","blockquote","code-block"],[{align:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{background:["rgb(  0,   0,   0)","rgb(230,   0,   0)","rgb(255, 153,   0)","rgb(255, 255,   0)","rgb(  0, 138,   0)","rgb(  0, 102, 204)","rgb(153,  51, 255)","rgb(255, 255, 255)","rgb(250, 204, 204)","rgb(255, 235, 204)","rgb(255, 255, 204)","rgb(204, 232, 204)","rgb(204, 224, 245)","rgb(235, 214, 255)","rgb(187, 187, 187)","rgb(240, 102, 102)","rgb(255, 194, 102)","rgb(255, 255, 102)","rgb(102, 185, 102)","rgb(102, 163, 224)","rgb(194, 133, 255)","rgb(136, 136, 136)","rgb(161,   0,   0)","rgb(178, 107,   0)","rgb(178, 178,   0)","rgb(  0,  97,   0)","rgb(  0,  71, 178)","rgb(107,  36, 178)","rgb( 68,  68,  68)","rgb( 92,   0,   0)","rgb(102,  61,   0)","rgb(102, 102,   0)","rgb(  0,  55,   0)","rgb(  0,  41, 102)","rgb( 61,  20,  10)"]}],[{color:["rgb(  0,   0,   0)","rgb(230,   0,   0)","rgb(255, 153,   0)","rgb(255, 255,   0)","rgb(  0, 138,   0)","rgb(  0, 102, 204)","rgb(153,  51, 255)","rgb(255, 255, 255)","rgb(250, 204, 204)","rgb(255, 235, 204)","rgb(255, 255, 204)","rgb(204, 232, 204)","rgb(204, 224, 245)","rgb(235, 214, 255)","rgb(187, 187, 187)","rgb(240, 102, 102)","rgb(255, 194, 102)","rgb(255, 255, 102)","rgb(102, 185, 102)","rgb(102, 163, 224)","rgb(194, 133, 255)","rgb(136, 136, 136)","rgb(161,   0,   0)","rgb(178, 107,   0)","rgb(178, 178,   0)","rgb(  0,  97,   0)","rgb(  0,  71, 178)","rgb(107,  36, 178)","rgb( 68,  68,  68)","rgb( 92,   0,   0)","rgb(102,  61,   0)","rgb(102, 102,   0)","rgb(  0,  55,   0)","rgb(  0,  41, 102)","rgb( 61,  20,  10)"]}],["clean"]],handlers:{image:m},history:{delay:500,maxStack:100,userOnly:!0}},imageResize:{displayStyles:{backgroundColor:"black",border:"none",color:"white"},modules:["Resize"]}}},[]),fe=function(){var U=ne()(N()().mark(function h(p){var w,f,C,e,b,B,Ae,se,ve,F;return N()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(p.preventDefault(),w=p.clipboardData||window.clipboardData,!w){Q.next=28;break}if(f=w.items,console.log("items=>",f),!f){Q.next=28;break}C=Array.from(f),e="",b=C.findIndex(function(ie){return ie.type===v.TEXT})!==-1,B=C.findIndex(function(ie){return ie.type===v.HTML})!==-1,Ae=C.findIndex(function(ie){return ie.type.indexOf(v.IMAGE)!==-1})!==-1,b&&!B&&(e=v.TEXT),Ae&&!B&&(e=v.IMAGE),B&&(e=v.HTML),se=0;case 15:if(!(se<f.length)){Q.next=28;break}if(ve=f[se],!(e!=="image"&&ve.type===e)){Q.next=21;break}ve.getAsString(function(){var ie=ne()(N()().mark(function Ne(ke){var De;return N()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return ge.next=2,Ce(ke);case 2:De=ge.sent,setTimeout(function(){var xe,Le=u==null||(xe=u.current)===null||xe===void 0?void 0:xe.getEditor(),Je=Le.getSelection().index;console.log(Le),Le.clipboard.dangerouslyPasteHTML(Je,De)},0);case 4:case"end":return ge.stop()}},Ne)}));return function(Ne){return ie.apply(this,arguments)}}()),Q.next=25;break;case 21:if(ve.type.indexOf(e)===-1){Q.next=25;break}return F=ve.getAsFile(),Q.next=25,x(F);case 25:se++,Q.next=15;break;case 28:case"end":return Q.stop()}},h)}));return function(p){return U.apply(this,arguments)}}(),Ce=function(){var U=ne()(N()().mark(function h(p){var w,f,C,e,b,B,Ae,se;return N()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:F.prev=0,w=new DOMParser,f=w.parseFromString(p,"text/html"),C=f.getElementsByTagName("img"),e=0;case 5:if(!(e<C.length)){F.next=17;break}if(b=C[e],!b.src.startsWith("data:image")){F.next=14;break}return B=b.src.split(",")[1],Ae=D(B),F.next=12,O(Ae);case 12:se=F.sent,b.src=se;case 14:e++,F.next=5;break;case 17:return F.abrupt("return",f.documentElement.outerHTML);case 20:return F.prev=20,F.t0=F.catch(0),console.log("uploadImgInPasteText\u51FA\u9519\u4E86",F.t0),F.abrupt("return",p);case 24:case"end":return F.stop()}},h,null,[[0,20]])}));return function(p){return U.apply(this,arguments)}}(),$e=new MutationObserver(function(U){var h=g()(U),p;try{for(h.s();!(p=h.n()).done;){var w=p.value;if(w.type==="attributes"&&w.attributeName==="width"){var f=w.target;f.style=null;var C=f.parentNode.offsetWidth,e=100/C*f.width;f.style.width="".concat(e.toFixed(2),"%")}}}catch(b){h.e(b)}finally{h.f()}}),Pe={attributes:!0,childList:!1,subtree:!1};return(0,Z.useEffect)(function(){console.log(u),u.current.editor.container.addEventListener("paste",fe),u.current.editor.root.addEventListener("DOMSubtreeModified",function(U){if(U.target.tagName==="IMG"){var h=U.target;$e.observe(h,Pe)}},!0)},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(be(),ue()({ref:u,theme:"snow",placeholder:"\u8BF7\u8F93\u5165",modules:X,style:{height:d.height}},d))})},y=J},4638:function(Ke,Te,r){"use strict";r.d(Te,{A9:function(){return ye},A_:function(){return g},IJ:function(){return Ee},YK:function(){return R},fx:function(){return j},hH:function(){return de},hY:function(){return N},mJ:function(){return Z},pJ:function(){return be},uJ:function(){return ne},v9:function(){return te}});var Be=r(12741),ue=r.n(Be),te={REGISTER:{label:"\u62A5\u540D",value:"REGISTER"},PLAYBACK:{label:"\u89C2\u770B\u56DE\u653E",value:"PLAYBACK"},ENTER:{label:"\u8FDB\u5165\u8BFE\u5802",value:"ENTER"},EXIT:{label:"\u9000\u51FA\u8BFE\u5802",value:"EXIT"},START_CLASS:{label:"\u4E0A\u8BFE",value:"START_CLASS"},STOP_CLASS:{label:"\u4E0B\u8BFE",value:"STOP_CLASS"},CHATGPT:{label:"CHATGPT",value:"CHATGPT"},RECEIVED_STREAMS:{label:"\u63A5\u6536\u6D41",value:"RECEIVED_STREAMS"},JOIN:{label:"\u7B7E\u5230",value:"JOIN"},CHAT:{label:"\u804A\u5929",value:"CHAT"},ON_SCREEN:{label:"\u4E0A\u5C4F",value:"ON_SCREEN"},OFF_SCREEN:{label:"\u4E0B\u5C4F",value:"OFF_SCREEN"},ALIVE:{label:"\u5728\u7EBF",value:"ALIVE"},ERROR:{label:"\u62A5\u9519",value:"ERROR"},TIMEOUT:{label:"\u8D85\u65F6",value:"TIMEOUT"},SELECT:{label:"\u9009\u62E9",value:"SELECT"}},g={NAME:"call",TITLE:"title",DATE:"date",CONTENT:"content",ROLE:"role",NOTE:"note"},i=[g.NAME,g.TITLE,g.DATE,g.NOTE],N=[{value:1641392,label:"\u4E0A\u8BFE\u901A\u77E51",params:i,getContent:function(D){var t=ue()(D,5),n=t[0],H=n===void 0?"":n,v=t[1],J=v===void 0?"":v,y=t[2],c=y===void 0?"":y,d=t[3],u=d===void 0?"":d,m=t[4],O=m===void 0?"":m;return"\u3010".concat(H,"\u3011").concat(J,"\uFF0C\u60A8\u62A5\u540D\u7684\u8BFE\u7A0B ").concat(c," \u5373\u5C06\u5F00\u59CB\uFF0C\u4E0A\u8BFE\u65F6\u95F4\u662F").concat(u," \uFF0C\u8BF7\u51C6\u65F6\u53C2\u52A0\u3002\u5907\u6CE8\uFF1A").concat(O," \u3002 \u56DET\u9000\u8BA2")}},{value:1646915,label:"\u4E0A\u8BFE\u901A\u77E52",params:i,getContent:function(D){var t=ue()(D,5),n=t[0],H=n===void 0?"":n,v=t[1],J=v===void 0?"":v,y=t[2],c=y===void 0?"":y,d=t[3],u=d===void 0?"":d,m=t[4],O=m===void 0?"":m;return"\u3010".concat(H,"\u3011").concat(J,"\u60A8\u597D,").concat(c,"\u5373\u5C06\u5F00\u8BB2, \u4E0A\u8BFE\u65F6\u95F4").concat(u,",\u5907\u6CE8\uFF1A").concat(O," \u3002 \u56DET\u9000\u8BA2")}},{value:1644970,label:"\u6D3B\u52A8\u901A\u77E5",params:[g.NAME,g.TITLE,g.ROLE,g.DATE,g.NOTE],getContent:function(D){var t=ue()(D,6),n=t[0],H=n===void 0?"":n,v=t[1],J=v===void 0?"":v,y=t[2],c=y===void 0?"":y,d=t[3],u=d===void 0?"":d,m=t[4],O=m===void 0?"":m,x=t[5],X=x===void 0?"":x;return"\u3010".concat(H,"\u3011\u6E29\u99A8\u63D0\u9192\uFF1A").concat(J,"\u5373\u5C06\u4E3E\u529E").concat(c,"\uFF0C\u672C\u6B21\u6D3B\u52A8\u9762\u5411").concat(u,"\uFF0C\u62A5\u540D\u65F6\u95F4\u622A\u6B62\u5230").concat(O,"\uFF0C\u6B22\u8FCE\u53C2\u52A0\u3002\u5907\u6CE8\uFF1A").concat(X," \u3002 \u56DET\u9000\u8BA2")}},{value:1641362,label:"\u8BFE\u7A0B\u62A5\u540D",params:[g.TITLE,g.NAME,g.DATE,g.NOTE],getContent:function(D){var t=ue()(D,5),n=t[0],H=n===void 0?"":n,v=t[1],J=v===void 0?"":v,y=t[2],c=y===void 0?"":y,d=t[3],u=d===void 0?"":d,m=t[4],O=m===void 0?"":m;return"\u3010".concat(H,"\u3011\u60A8\u597D\uFF0C\u300A").concat(J,"\u300B\u5373\u5C06\u5F00\u8BB2\uFF0C\u7531 ").concat(c," \u4EB2\u4E34\u6388\u8BFE\uFF0C\u62A5\u540D\u65F6\u95F4\u622A\u6B62\u5230").concat(u,"\uFF0C \u4E0D\u8981\u9519\u8FC7\u54E6! \u5907\u6CE8\uFF1A ").concat(O," \u3002 \u56DET\u9000\u8BA2")}},{value:1981363,label:"\u5F00\u73ED\u901A\u77E5",params:[g.NAME,g.TITLE,g.CONTENT,g.NOTE],getContent:function(D){var t=ue()(D,5),n=t[0],H=n===void 0?"":n,v=t[1],J=v===void 0?"":v,y=t[2],c=y===void 0?"":y,d=t[3],u=d===void 0?"":d,m=t[4],O=m===void 0?"":m;return"\u3010".concat(H,"\u3011").concat(J,",").concat(c,"\u5373\u5C06\u5F00\u59CB\uFF0C").concat(u," \u3002\u5907\u6CE8\uFF1A").concat(O," \u3002\u62D2\u6536\u8BF7\u56DE\u590DR")}},{value:1981205,label:"\u4E0A\u8BFE\u524D\u901A\u77E5",params:[g.NAME,g.TITLE,g.NOTE],getContent:function(D){var t=ue()(D,4),n=t[0],H=n===void 0?"":n,v=t[1],J=v===void 0?"":v,y=t[2],c=y===void 0?"":y,d=t[3],u=d===void 0?"":d;return"\u3010".concat(H,"\u3011").concat(J,"\uFF0C\u60A8\u62A5\u540D\u7684\u8BFE\u7A0B ").concat(c," \uFF0C\u8BF7\u51C6\u65F6\u53C2\u52A0\u3002\u5907\u6CE8\uFF1A").concat(u," \u3002")}}],I=function(S){return S.STUDENT="1",S.TEACHER="2",S.VISITOR="3",S.TUTOR="4",S.ADMIN="5",S.PARENT="6",S}({}),ne=[{value:I.TEACHER,color:"geekblue",label:"\u6559\u5E08"},{value:I.TUTOR,color:"blue",label:"\u52A9\u6559"},{value:I.STUDENT,color:"cyan",label:"\u5B66\u751F"},{value:I.ADMIN,color:"red",label:"\u7BA1\u7406\u5458"}],Z={NONE:"0",ONLY_ROOM:"1",ONLY_PLAYBACK:"2",ALL_RIGNHT:"3"},ye={ROOM:{name:"ROOM",label:"verify_room",value:1},PLAYBACK:{name:"PLAYBACK",label:"verify_playback",value:2}},j=function(D,t,n){var H=n?t:t*-1;return(parseInt(D)+H).toString()},R=["\u5927\u4E00","\u5927\u4E8C","\u5927\u4E09","\u5927\u56DB","\u7855\u58EB\u7814\u7A76\u751F","\u535A\u58EB\u7814\u7A76\u751F","\u5927\u5B66\u8001\u5E08","\u516C\u53F8\u6280\u672F\u5DE5\u7A0B\u5E08","\u5176\u4ED6"],be=[{value:"\u672A\u8BA2\u9605\u901A\u77E5",label:"\u4E0D\u8BA2\u9605\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u77ED\u4FE1\u901A\u77E5",label:"\u8BA2\u9605\u77ED\u4FE1\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u7535\u8BDD\u901A\u77E5",label:"\u8BA2\u9605\u7535\u8BDD\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u5168\u90E8\u901A\u77E5",label:"\u8BA2\u9605\u5168\u90E8\u901A\u77E5"}],Ee=/^(\+86|86)?1[3-9]\d{9}$|^(\+886|0)9\d{8}$/,de=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/},30269:function(Ke,Te,r){"use strict";r.r(Te),r.d(Te,{default:function(){return lr}});var Be=r(95855),ue=r(64129),te=r.n(ue),g=r(97983),i=r.n(g),N=r(40794),I=r.n(N),ne=r(11281),Z=r.n(ne),ye=r(12741),j=r.n(ye),R=r(67294),be=r(10703),Ee=r(25641),de=r(99644),S=r(47745),D=r(85402),t=r(95239),n=r(12461),H=r(35295),v=r(62270),J=r(57778),y=r(13714),c=r(4638),d=r(2641),u=r(9669),m=r.n(u);function O(z){return x.apply(this,arguments)}function x(){return x=_asyncToGenerator(_regeneratorRuntime().mark(function z(M){return _regeneratorRuntime().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",request("/base/api/email/sendEmail",{method:"POST",headers:{"Content-Type":"application/json",Accept:"*/*"},data:M}));case 1:case"end":return V.stop()}},z)})),x.apply(this,arguments)}var X="http://101.200.208.215:4000";function fe(z,M){return Ce.apply(this,arguments)}function Ce(){return Ce=I()(i()().mark(function z(M,G){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",m().post(X+"/api/v1/email/send_email_group",M,{onDownloadProgress:G}));case 1:case"end":return l.stop()}},z)})),Ce.apply(this,arguments)}function $e(z){return Pe.apply(this,arguments)}function Pe(){return Pe=I()(i()().mark(function z(M){var G;return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,m()(X+"/api/v1/msms/inform",{method:"post",headers:{"Content-Type":"application/json"},data:JSON.stringify(Z()({},M))});case 2:return G=l.sent,console.log("\u8BF7\u6C42\u7ED3\u679C",G),l.abrupt("return",G.data);case 5:case"end":return l.stop()}},z)})),Pe.apply(this,arguments)}function U(z){return h.apply(this,arguments)}function h(){return h=I()(i()().mark(function z(M){var G;return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,m().get(X+"/api/v1/msms/get_signature/?clientId=".concat(M));case 2:if(G=l.sent,G.data.errcode!==200){l.next=7;break}return l.abrupt("return",G.data.data);case 7:return l.abrupt("return","");case 8:case"end":return l.stop()}},z)})),h.apply(this,arguments)}var p=r(57546),w=r(81961),f=r(71577),C=r(84105),e=r(85893),b=function(M){var G=(0,R.useState)(!1),V=j()(G,2),l=V[0],me=V[1],oe=function(ce){var ee,q=[],_=[],Se=new Uint8Array((ee=ce.target)===null||ee===void 0?void 0:ee.result),Y=C.ij(Se,{type:"array"});for(var pe in Y.Sheets)if(Y.Sheets.hasOwnProperty(pe)){var Fe=Y.Sheets[pe],Ze=C.P6.sheet_to_json(Fe,{header:1});_=[].concat(te()(_),te()(Ze))}_.forEach(function(we){we.forEach(function(k){M.regex.test(k)&&q.push(k)})}),M.onChange(q),me(!1)},he=function(){var Oe=I()(i()().mark(function ce(ee){var q,_;return i()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return me(!0),q=ee,q?(_=new FileReader,_.onload=oe,_.readAsArrayBuffer(q)):me(!1),Y.abrupt("return","");case 4:case"end":return Y.stop()}},ce)}));return function(ee){return Oe.apply(this,arguments)}}();return(0,e.jsx)(w.Z,{name:"file",action:he,className:"upload",fileList:[],accept:".xlsx",children:(0,e.jsx)(f.Z,{icon:(0,e.jsx)(p.Z,{}),type:"primary",loading:l,id:"upload-btn",children:"\u5BFC\u5165"})})},B=D.Z.confirm,Ae=3e3,se=function(){var M,G=t.Z.useForm(),V=j()(G,1),l=V[0],me=(0,R.useState)([]),oe=j()(me,2),he=oe[0],Oe=oe[1],ce=(0,R.useState)(!1),ee=j()(ce,2),q=ee[0],_=ee[1],Se=(0,R.useState)(!1),Y=j()(Se,2),pe=Y[0],Fe=Y[1],Ze=(0,R.useState)(new Map),we=j()(Ze,2),k=we[0],A=we[1],K=(0,R.useState)({}),re=j()(K,2),L=re[0],ae=re[1],ze=(0,R.useState)(""),Me=j()(ze,2),Ie=Me[0],Ve=Me[1],Re=(0,R.useState)(),He=j()(Re,2),W=He[0],sr=He[1],ir=(0,R.useState)(!1),or=j()(ir,1),cr=or[0],dr=(0,R.useState)([]),Qe=j()(dr,2),fr=Qe[0],vr=Qe[1],gr={labelCol:{span:6},wrapperCol:{span:14}},mr=function(){var a=localStorage.getItem("client");if(!a)return{clientId:"1"};var o=JSON.parse(a);return o},hr=function(){var a=l.getFieldValue("phones");a&&(_(a.length===he.length),Fe(a.length>0&&a.length<he.length))},qe=function(){_(!1),Fe(!1),l.setFieldValue("phones",[]),l.setFieldValue("inputPhones",[]),ae(Z()(Z()({},L),{},{phones:[],inputPhones:[]}))},_e=function(a,o){L[a]=o,ae(Z()({},L)),a==="template"&&sr(c.hY.find(function(T){return T.value===o}))},pr=function(a){l.setFieldValue("phones",a.target.checked?he:[]),_e("phones",a.target.checked?he:[]),Fe(!1),_(a.target.checked)},er=function(){var s=I()(i()().mark(function a(o){var T,$,le;return i()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,y.Zy)({size:Ae,courseId:o});case 2:if(P.t0=P.sent.data,P.t0){P.next=5;break}P.t0=[];case 5:T=P.t0,$=[],le=[],T.forEach(function(){var rr=I()(i()().mark(function je(Ue){var Ge,ar;return i()().wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:Ge=Ue.phone,ar=Ue.name,$.findIndex(function(Sr){return Sr.includes(Ge)})<0&&($.push([Ge,"".concat(ar,"<").concat(Ge,">")]),le.push(Ge));case 2:case"end":return Ye.stop()}},je)}));return function(je){return rr.apply(this,arguments)}}()),qe(),Oe([].concat(le)),A(new Map([].concat($)));case 12:case"end":return P.stop()}},a)}));return function(o){return s.apply(this,arguments)}}(),br=function(){var s=I()(i()().mark(function a(o){var T,$;return i()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return $="\u300A".concat((T=fr.find(function(P){return P.value===o}))===null||T===void 0?void 0:T.label,"\u300B"),l.setFieldValue("title",$),L.title=$,ae(Z()({},L)),E.next=6,o==="1"?er():er(o.slice(-3));case 6:case"end":return E.stop()}},a)}));return function(o){return s.apply(this,arguments)}}(),Er=function(){var s=I()(i()().mark(function a(o){var T,$;return i()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return T={templateId:W.value,signature:Ie,data:W==null?void 0:W.params.map(function(P){return o[P]}),phones:o.phones},E.prev=1,E.next=4,$e(T);case 4:if($=E.sent,$.errcode!==200){E.next=10;break}return n.ZP.success("\u53D1\u9001\u6210\u529F"),E.abrupt("return",!0);case 10:return n.ZP.error("\u53D1\u9001\u5931\u8D25,\u8BF7\u91CD\u8BD5"),E.abrupt("return",!1);case 12:E.next=19;break;case 14:return E.prev=14,E.t0=E.catch(1),n.ZP.error("\u53D1\u9001\u5931\u8D25"),console.log("\u53D1\u9001\u9519\u8BEF",E.t0),E.abrupt("return",!1);case 19:case"end":return E.stop()}},a,null,[[1,14]])}));return function(o){return s.apply(this,arguments)}}(),Cr=function(){var s=I()(i()().mark(function a(o){var T,$,le,E,P;return i()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:T=o.phones,$=o.inputPhones,le=$===void 0?"":$,E=[],le&&typeof le=="string"&&(E=le.split(";")),P=[].concat(te()(T),te()(E)).filter(function(Ue){return c.IJ.test(Ue)}),!P||P.length<1?n.ZP.warn("\u8BF7\u9009\u62E9\u8054\u7CFB\u4EBA\u6216\u8005\u6DFB\u52A0\u624B\u673A\u53F7"):B({title:"\u60A8\u786E\u5B9A\u8981\u53D1\u9001\u4FE1\u606F\u5417\uFF1F",onOk:function(){Er(Z()(Z()({},o),{},{phones:P})),qe()}});case 5:case"end":return je.stop()}},a)}));return function(o){return s.apply(this,arguments)}}();(0,R.useEffect)(function(){U(mr().clientId).then(function(s){Ve(s)})},[]);var Ar=[Ie].concat(W==null?void 0:W.params.map(function(s){return L[s]}));return(0,e.jsxs)("div",{className:"sms-container",children:[(0,e.jsx)("div",{className:"preview",children:(0,e.jsx)(H.Z,{title:"\u9884\u89C8",children:(0,e.jsx)("p",{style:{width:"200px"},children:W?W.getContent(Ar):"\u8BF7\u9009\u62E9\u4E00\u4E2A\u77ED\u4FE1\u6A21\u677F"})})}),(0,e.jsxs)(be.A,Z()(Z()({className:"form",form:l},gr),{},{autoFocusFirstInput:!0,onFieldsChange:function(a){return _e(a[0].name[0],a[0].value)},onFinish:function(){var s=I()(i()().mark(function a(o){return i()().wrap(function($){for(;;)switch($.prev=$.next){case 0:Cr(o);case 1:case"end":return $.stop()}},a)}));return function(a){return s.apply(this,arguments)}}(),children:[(0,e.jsx)(Ee.Z,{request:I()(i()().mark(function s(){var a;return i()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,J.tS)();case 2:return a=T.sent,vr(te()(a)),a.unshift({label:"\u5168\u90E8",value:"1"}),T.abrupt("return",a);case 6:case"end":return T.stop()}},s)})),fieldProps:{onChange:function(a){return br(a)}},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9700\u8981\u53D1\u9001\u7684\u8BFE\u7A0B"}],width:"lg",name:"sendTo",label:"\u8BFE\u7A0B",placeholder:"\u8BF7\u9009\u62E9\u8BFE\u7A0B"}),(0,e.jsx)(Ee.Z,{request:I()(i()().mark(function s(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",c.hY);case 1:case"end":return o.stop()}},s)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u77ED\u4FE1\u6A21\u677F"}],width:"lg",name:"template",label:"\u77ED\u4FE1\u6A21\u677F",placeholder:"\u8BF7\u9009\u62E9\u77ED\u4FE1\u6A21\u677F",allowClear:!0}),(0,e.jsx)(Ee.Z,{valueEnum:k,fieldProps:{mode:"multiple",onChange:hr,maxTagCount:10,loading:cr},width:"lg",name:"phones",label:"\u8054\u7CFB\u4EBA",placeholder:"\u8BF7\u9009\u62E9\u8054\u7CFB\u4EBA",allowClear:!0,addonAfter:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(v.default,{onChange:pr,indeterminate:pe,checked:q,children:"\u5168\u9009"}),(0,e.jsx)("span",{children:"".concat(((M=L.phones)===null||M===void 0?void 0:M.length)||0,"/").concat(k.size)})]})}),(0,e.jsx)(de.Z,{width:"lg",name:"inputPhones",label:"\u6DFB\u52A0\u624B\u673A\u53F7",placeholder:"\u624B\u52A8\u8F93\u5165\u624B\u673A\u53F7,\u7528\u82F1\u6587\u9017\u53F7\u9694\u5F00",addonAfter:(0,e.jsx)(b,{regex:c.IJ,onChange:function(a){return l.setFieldValue("inputPhones",a.join(";"))}})}),(0,e.jsx)(be.A.Group,{children:W==null?void 0:W.params.map(function(s,a){return s===c.A_.NAME?(0,e.jsx)(S.Z,{width:"lg",name:"call",label:"\u79F0\u547C",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u79F0\u547C"}]},a):s===c.A_.TITLE?(0,e.jsx)(S.Z,{width:"lg",name:"title",label:"\u6807\u9898",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},a):s===c.A_.DATE?(0,e.jsx)(S.Z,{width:"lg",name:"date",label:"\u65E5\u671F",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u65F6\u95F4"}]},a):s===c.A_.ROLE?(0,e.jsx)(S.Z,{width:"lg",name:"role",label:"\u89D2\u8272",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272"}]},a):s===c.A_.CONTENT?(0,e.jsx)(S.Z,{width:"lg",name:"content",label:"\u5185\u5BB9",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}]},a):s===c.A_.NOTE?(0,e.jsx)(de.Z,{width:"lg",name:"note",label:"\u5907\u6CE8",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5907\u6CE8\u5185\u5BB9"}],fieldProps:{showCount:!0,maxLength:300,defaultValue:"\u4E0A\u8BFE\u94FE\u63A5\uFF1A"},placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},a):(0,e.jsx)(e.Fragment,{})})})]}))]})},ve=se,F=r(93637),We=r(71694),Q=r(98442),ie=r(44784),Ne=r(59652),ke=r(71230),De=r(15746),Xe=r(26713),ge=r(20550),xe=r(96486),Le=D.Z.confirm,Je={labelCol:{span:6},wrapperCol:{span:14}},tr=function(){var M=t.Z.useForm(),G=j()(M,1),V=G[0],l=(0,R.useState)("text"),me=j()(l,2),oe=me[0],he=me[1],Oe=(0,R.useState)([]),ce=j()(Oe,2),ee=ce[0],q=ce[1],_=(0,R.useState)(0),Se=j()(_,2),Y=Se[0],pe=Se[1];F.U.on("newSend",q);var Fe=function(A){var K=A.target,re=K.responseText;try{var L=re.split(`
`).map(function(ae){return JSON.parse(ae)});console.log(L),F.U.emit("newSend",te()(L))}catch(ae){console.log(ae)}},Ze=function(A){q([]),pe(0);var K=A.content,re=A.emails,L=re===void 0?"":re,ae=A.title,ze=A.type,Me="";try{var Ie=JSON.parse(localStorage.getItem("client")||"{}");Me=Ie==null?void 0:Ie.clientName}catch(Re){console.log(Re)}var Ve=te()(new Set(L.split(";")));pe(Ve.length),fe({clientName:Me,emails:Ve,title:ae,content:K,type:ze},Fe).then(function(Re){var He=Re.data.errcode,W=He===void 0?200:He;W===100&&(n.ZP.error("\u90AE\u4EF6\u5185\u5BB9\u8FC7\u957F\uFF0C\u8BF7\u51CF\u5C0F\u5185\u5BB9\u540E\u91CD\u8BD5"),q([]),pe(0)),console.log("==>\u53D1\u9001\u5B8C\u6BD5",Re)}).catch(function(){n.ZP.error("\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}),V.setFieldValue("emails",""),n.ZP.success("\u6B63\u5728\u53D1\u9001\u90AE\u4EF6")},we=function(A){var K=A.emails,re=K.split(";"),L=re.findIndex(function(ae){return!c.hH.test(ae)});L>-1?n.ZP.error("\u90AE\u7BB1\u683C\u5F0F\u6709\u8BEF"):Le({title:"\u60A8\u786E\u5B9A\u8981\u53D1\u9001\u90AE\u4EF6\u5417\uFF1F",onOk:function(){Ze(A)}})};return(0,R.useEffect)(function(){return function(){F.U.off("newSend",q)}},[]),(0,e.jsxs)("div",{className:"email-send-container",children:[(0,e.jsx)(Ne.Z,{title:"\u53D1\u9001\u90AE\u4EF6",bordered:!1,style:{width:800},children:(0,e.jsxs)(be.A,Z()(Z()({form:V,className:"form"},Je),{},{autoFocusFirstInput:!0,grid:!0,layout:"horizontal",labelCol:{span:3},wrapperCol:{span:14},initialValues:{web_site_name:"all"},onFinish:function(){var k=I()(i()().mark(function A(K){return i()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:we(K);case 1:case"end":return L.stop()}},A)}));return function(A){return k.apply(this,arguments)}}(),submitter:{render:function(A,K){return(0,e.jsx)(ke.Z,{style:{marginTop:oe==="html"?"50px":""},children:(0,e.jsx)(De.Z,{span:1,offset:3,children:(0,e.jsx)(Xe.Z,{children:K})})})}},children:[(0,e.jsx)(S.Z,{fieldProps:{maxLength:50,showCount:!0},rules:[{required:!0,message:"\u8BF7\u586B\u5199\u90AE\u4EF6\u6807\u9898"}],width:"lg",name:"title",label:"\u6807\u9898",placeholder:"\u8BF7\u8F93\u5165\u90AE\u4EF6\u6807\u9898",allowClear:!0}),(0,e.jsx)(de.Z,{fieldProps:{showCount:!0},rules:[{required:!0,message:"\u90AE\u7BB1\u4E0D\u80FD\u4E3A\u7A7A"}],width:"lg",name:"emails",label:"\u90AE\u7BB1",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u5E76\u7528\u82F1\u6587;\u9694\u5F00",allowClear:!0,addonAfter:(0,e.jsx)(b,{regex:c.hH,onChange:function(A){return V.setFieldValue("emails",A.join(";"))}})}),(0,e.jsx)(Q.Z.Group,{width:"lg",name:"type",required:!0,label:"\u90AE\u4EF6\u7C7B\u578B",fieldProps:{value:oe,onChange:function(A){return he(A.target.value)}},options:[{label:"\u6587\u672C",value:"text"},{label:"\u5BCC\u6587\u672C",value:"html"}]}),oe==="html"&&(0,e.jsx)(De.Z,{span:24,children:(0,e.jsx)(t.Z.Item,{label:"\u6B63\u6587\u5185\u5BB9",name:"content",required:!0,className:"content",rules:[{validator:function(A,K){return(0,xe.isEmpty)(K.replace("<p><br></p>",""))?Promise.reject(new Error("\u8BF7\u586B\u5199\u6B64\u9879")):Promise.resolve()}}],children:(0,e.jsx)(We.Z,{height:400})})}),oe==="text"&&(0,e.jsx)(de.Z,{fieldProps:{showCount:!0,rows:20,maxLength:2e3},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u4EF6\u6B63\u6587\u5185\u5BB9"}],width:"lg",name:"content",label:"\u6B63\u6587\u5185\u5BB9",placeholder:"\u8BF7\u8F93\u5165\u90AE\u4EF6\u6B63\u6587\u5185\u5BB9",allowClear:!0})]}))}),Y>0&&(0,e.jsx)(Ne.Z,{title:"\u53D1\u9001\u7ED3\u679C(".concat(ee.length,"/").concat(Y,")"),bordered:!1,style:{overflowY:"scroll",width:500},children:(0,e.jsx)(ie.Z,{className:"email-send-table",pagination:!1,toolBarRender:!1,search:!1,dataSource:ee,columns:[{title:"\u5E8F\u53F7",dataIndex:"index",align:"center",search:!1,render:function(A,K,re){return re+1}},{title:"\u90AE\u7BB1",dataIndex:"email",align:"center",search:!1},{title:"\u53D1\u9001\u7ED3\u679C",dataIndex:"isOk",align:"center",search:!1,render:function(A){return A?(0,e.jsx)(ge.Z,{color:"#87d068",children:"\u6210\u529F"}):(0,e.jsx)(ge.Z,{color:"#f50",children:"\u5931\u8D25"})}}]})})]})},nr=tr,ur=function(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Be._z,{className:"operate-container",tabList:[{tab:"\u77ED\u4FE1\u901A\u77E5",key:"sms",children:(0,e.jsx)(ve,{})},{tab:"\u90AE\u4EF6\u901A\u77E5",key:"email",children:(0,e.jsx)(nr,{})}]})})},lr=ur},20067:function(){}}]);

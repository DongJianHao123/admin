"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[335],{77500:function(ve,L,e){e.r(L),e.d(L,{default:function(){return re}});var V=e(97983),u=e.n(V),U=e(11281),m=e.n(U),r=e(40794),s=e.n(r),i=e(12741),l=e.n(i),g=e(14971),c=e(42350),C=e(67294),M=e(12461),b=e(63154),ue=e(84057),S=e(71167),x=e.n(S),B=e(9128),A=e.n(B),o=e(85893);S.Quill.register("modules/imageResize",A());var F=function(K){var O=(0,C.useRef)(null),H=function(){var j=s()(u()().mark(function ne(){var D;return u()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:D=document.createElement("input"),D.setAttribute("type","file"),D.setAttribute("accept","image/*"),D.click(),D.onchange=function(){var p=D.files[0],t=M.ZP.loading("\u4E0A\u4F20\u4E2D...",0);(0,b.Wi)(p).then(function(h){var T,I="https://ssl.cdn.maodouketang.com/".concat(h.key),z=O==null||(T=O.current)===null||T===void 0?void 0:T.getEditor(),ae=z.getSelection().index;z.insertEmbed(ae,"image",I),z.setSelection(ae+1),t()})};case 5:case"end":return a.stop()}},ne)}));return function(){return j.apply(this,arguments)}}(),G=(0,C.useMemo)(function(){return{toolbar:{container:[["bold","italic","underline","strike","blockquote","code-block"],[{align:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{background:["rgb(  0,   0,   0)","rgb(230,   0,   0)","rgb(255, 153,   0)","rgb(255, 255,   0)","rgb(  0, 138,   0)","rgb(  0, 102, 204)","rgb(153,  51, 255)","rgb(255, 255, 255)","rgb(250, 204, 204)","rgb(255, 235, 204)","rgb(255, 255, 204)","rgb(204, 232, 204)","rgb(204, 224, 245)","rgb(235, 214, 255)","rgb(187, 187, 187)","rgb(240, 102, 102)","rgb(255, 194, 102)","rgb(255, 255, 102)","rgb(102, 185, 102)","rgb(102, 163, 224)","rgb(194, 133, 255)","rgb(136, 136, 136)","rgb(161,   0,   0)","rgb(178, 107,   0)","rgb(178, 178,   0)","rgb(  0,  97,   0)","rgb(  0,  71, 178)","rgb(107,  36, 178)","rgb( 68,  68,  68)","rgb( 92,   0,   0)","rgb(102,  61,   0)","rgb(102, 102,   0)","rgb(  0,  55,   0)","rgb(  0,  41, 102)","rgb( 61,  20,  10)"]}],[{color:["rgb(  0,   0,   0)","rgb(230,   0,   0)","rgb(255, 153,   0)","rgb(255, 255,   0)","rgb(  0, 138,   0)","rgb(  0, 102, 204)","rgb(153,  51, 255)","rgb(255, 255, 255)","rgb(250, 204, 204)","rgb(255, 235, 204)","rgb(255, 255, 204)","rgb(204, 232, 204)","rgb(204, 224, 245)","rgb(235, 214, 255)","rgb(187, 187, 187)","rgb(240, 102, 102)","rgb(255, 194, 102)","rgb(255, 255, 102)","rgb(102, 185, 102)","rgb(102, 163, 224)","rgb(194, 133, 255)","rgb(136, 136, 136)","rgb(161,   0,   0)","rgb(178, 107,   0)","rgb(178, 178,   0)","rgb(  0,  97,   0)","rgb(  0,  71, 178)","rgb(107,  36, 178)","rgb( 68,  68,  68)","rgb( 92,   0,   0)","rgb(102,  61,   0)","rgb(102, 102,   0)","rgb(  0,  55,   0)","rgb(  0,  41, 102)","rgb( 61,  20,  10)"]}],["clean"]],handlers:{image:H},history:{delay:500,maxStack:100,userOnly:!0}},imageResize:{displayStyles:{backgroundColor:"black",border:"none",color:"white"},modules:["Resize","DisplaySize"]}}},[]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(x(),m()({ref:O,theme:"snow",placeholder:"\u8BF7\u8F93\u5165",modules:G,style:{height:600}},K))})},de=F,ie=e(19240),d=e(13714),w=e(95855),me=e(10703),J=e(47745),pe=e(91681),q=e(25641),Q=e(60014),Y=e(736),le=e(97072),X=e(36275),N=e(95239),Z=e(71230),ce=e(15746),ee=e(26713),f=e(71577),W=e(96486),fe=function(){var K=(0,X.useParams)(),O=K.courseId,H=N.Z.useForm(),G=l()(H,1),j=G[0],ne=(0,C.useState)(!1),D=l()(ne,2),n=D[0],a=D[1],p=(0,C.useState)(!1),t=l()(p,2),h=t[0],T=t[1],I=(0,C.useState)(""),z=l()(I,2),ae=z[0],he=z[1],E=(0,C.useState)(""),v=l()(E,2),R=v[0],k=v[1],$=O==="0"||!O,se=function(_){k(_)},oe=function(_){(0,b.Wi)(_).then(function(y){j.setFieldsValue({coverUrl:[Object.assign(_,{url:"https://ssl.cdn.maodouketang.com/".concat(y.key)})]})})},Ee=(0,X.useRequest)(d.qm,{manual:!0}),ge=Ee.run,be=(0,X.useRequest)(d.No,{manual:!0}),Be=be.run,Pe=function(){var P=s()(u()().mark(function _(y){var je,De,Ce;return u()().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return je=l()(y.coverUrl,1),De=je[0],Ce=m()(m()({},y),{},{coverUrl:De.url}),ye.abrupt("return",($?(0,d.P6)(Ce):(0,d.Hf)(Ce)).then(function(){M.ZP.success("".concat($?"\u6DFB\u52A0":"\u4FEE\u6539","\u6210\u529F")),history.back()}));case 3:case"end":return ye.stop()}},_)}));return function(y){return P.apply(this,arguments)}}(),Me=function(){var _=j.getFieldValue("title");g.Z.str.isEmpty(_)?M.ZP.warn("\u8BF7\u5148\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0"):T(!0)};return(0,C.useEffect)(function(){$?ge().then(function(P){return j.setFieldsValue({courseId:100+ +P+1})}):Be(O).then(j.setFieldsValue)},[O]),(0,C.useEffect)(function(){h&&he(j.getFieldValue("title"))},[h]),(0,o.jsxs)(w._z,{header:{title:"".concat($?"\u65B0\u5EFA":"\u7F16\u8F91","\u8BFE\u7A0B"),onBack:function(){return history.back()}},style:{paddingBottom:"100px"},children:[(0,o.jsxs)(me.A,{form:j,grid:!0,layout:"horizontal",labelCol:{span:4},wrapperCol:{span:12},initialValues:{web_site_name:"all"},onFinish:Pe,submitter:{render:function(_,y){return(0,o.jsx)(Z.Z,{style:{marginTop:"90px"},children:(0,o.jsx)(ce.Z,{span:14,offset:4,children:(0,o.jsx)(ee.Z,{children:y})})})}},children:[(0,o.jsx)(J.Z,{name:"title",label:"\u8BFE\u7A0B\u540D\u79F0",colProps:{md:24,xl:24},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:b.n0}),(0,o.jsx)(J.Z,{name:"summary",label:"\u4E00\u53E5\u8BDD\u7B80\u4ECB",colProps:{md:24,xl:24},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:b.n0}),(0,o.jsxs)(pe.UW,{children:[(0,o.jsx)(q.Z,{label:"\u8BFE\u7A0B\u7C7B\u578B",name:"type",labelCol:{span:12},colProps:{md:24,xl:8},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:b.n0,request:s()(u()().mark(function P(){return u()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",[{value:3,label:"\u5C0F\u73ED\u8BFE(15\u4EBA\u4EE5\u4E0B)"},{value:6,label:"\u5927\u73ED\u8BFE(16\u4EBA\u4EE5\u4E0A)"}]);case 1:case"end":return y.stop()}},P)}))}),(0,o.jsx)(q.Z,{label:"\u70ED\u95E8/\u975E\u70ED\u95E8",name:"tag",labelCol:{span:12},colProps:{md:24,xl:8},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:b.n0,request:s()(u()().mark(function P(){return u()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",[{value:"hot",label:"\u70ED\u95E8"},{value:"notHot",label:"\u975E\u70ED\u95E8"}]);case 1:case"end":return y.stop()}},P)}))})]}),(0,o.jsxs)(pe.UW,{children:[(0,o.jsx)(Q.Z,{name:"courseIndex",label:"\u6392\u5E8F",labelCol:{span:16},colProps:{md:24,xl:6},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:b.n0}),(0,o.jsx)(Q.Z,{name:"oldPrice",label:"\u539F\u4EF7",labelCol:{span:8},colProps:{md:24,xl:6},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:b.n0}),(0,o.jsx)(Q.Z,{name:"price",label:"\u73B0\u4EF7",labelCol:{span:4},colProps:{md:24,xl:6},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:b.n0})]}),(0,o.jsx)(J.Z,{name:"teacher",label:"\u4EFB\u8BFE\u6559\u5E08",labelCol:{span:6},colProps:{md:12,xl:16},placeholder:"\u8BF7\u8F93\u5165"}),(0,o.jsx)(Y.Z,{name:"coverUrl",label:"\u8BFE\u7A0B\u56FE\u7247",max:1,required:!0,fieldProps:{name:"file",listType:"picture-card"},rules:b.n0,action:oe,extra:"\u5EFA\u8BAE\u56FE\u7247\u6BD4\u4F8B\u4E3A16:9",accept:"image/*"}),(0,o.jsx)(le.Z,{label:"\u5E2E\u52A9",labelCol:{span:6},colProps:{md:12,xl:16},children:(0,o.jsx)(f.Z,{ghost:!0,onClick:function(){return Me()},type:"primary",children:"\u751F\u6210\u8BFE\u7A0B\u4ECB\u7ECD"})}),(0,o.jsx)(ce.Z,{span:24,children:(0,o.jsx)(N.Z.Item,{label:"\u8BFE\u7A0B\u4ECB\u7ECD",name:"introduction",required:!0,rules:[{validator:function(_,y){return(0,W.isEmpty)(y.replace("<p><br></p>",""))?Promise.reject(new Error("\u8BF7\u586B\u5199\u6B64\u9879")):Promise.resolve()}}],children:(0,o.jsx)(de,{})})}),(0,o.jsx)(N.Z.Item,{name:"courseId",noStyle:!0}),(0,o.jsx)(N.Z.Item,{name:"id",noStyle:!0})]}),(0,o.jsx)(c.Z,{open:h,handleClose:function(){return T(!1)},prompt:"\u300A".concat(ae,"\u300B\u7684\u8BFE\u7A0B\u5927\u7EB2")})]})},re=fe},19240:function(ve,L,e){e.d(L,{jO:function(){return c},o$:function(){return M},rz:function(){return ue}});var V=e(97983),u=e.n(V),U=e(11281),m=e.n(U),r=e(40794),s=e.n(r),i=e(9669),l=e.n(i),g="http://101.201.249.16:4000";function c(S){return C.apply(this,arguments)}function C(){return C=s()(u()().mark(function S(x){var B;return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,l()(g+"/api/v1/msms/inform",{method:"post",headers:{"Content-Type":"application/json"},data:JSON.stringify(m()({},x))});case 2:return B=o.sent,console.log("\u8BF7\u6C42\u7ED3\u679C",B),o.abrupt("return",B.data);case 5:case"end":return o.stop()}},S)})),C.apply(this,arguments)}function M(S){return b.apply(this,arguments)}function b(){return b=s()(u()().mark(function S(x){var B;return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,l().get(g+"/api/v1/msms/get_signature/?clientId=".concat(x));case 2:if(B=o.sent,B.data.errcode!==200){o.next=7;break}return o.abrupt("return",B.data.data);case 7:return o.abrupt("return","");case 8:case"end":return o.stop()}},S)})),b.apply(this,arguments)}var ue=function(x,B,A){l()({method:"post",url:"https://api.os2edu.cn/api/chat-process",data:{prompt:x,options:{parentMessageId:B},systemMessage:"\u4F60\u73B0\u5728\u662F\u4E00\u4E2A\u6559\u80B2\u5DE5\u4F5C\u8005\uFF0C\u4F60\u9700\u8981\u8F85\u52A9\u6211\u7BA1\u7406\u597D\u4E00\u4E2A\u6559\u80B2\u673A\u6784\u7684\u540E\u53F0\uFF0C\u7B80\u5316\u6211\u4EEC\u7684\u5DE5\u4F5C",temperature:.8,top_p:1},onDownloadProgress:A}).then(function(){})}},13714:function(ve,L,e){e.d(L,{$H:function(){return ne},EP:function(){return me},Gr:function(){return d},Hf:function(){return f},No:function(){return te},P6:function(){return ce},Rq:function(){return le},Zy:function(){return B},_I:function(){return G},fZ:function(){return o},hS:function(){return de},qY:function(){return Q},qm:function(){return fe},se:function(){return O},so:function(){return N},wA:function(){return S}});var V=e(97983),u=e.n(V),U=e(11281),m=e.n(U),r=e(97548),s=e.n(r),i=e(40794),l=e.n(i),g=e(63154),c=e(36275),C=e(27484),M=e.n(C),b=["classroomStatus"],ue=["coverUrl"];function S(n){return x.apply(this,arguments)}function x(){return x=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/coursesget/getAllCoursesByConditionsWithTotal?clientId=385&isDelete=1",{params:m()({},a)}).then(function(h){return{data:(0,g.we)(h.courseList,a),total:h.totalNum,success:!0}}));case 1:case"end":return t.stop()}},n)})),x.apply(this,arguments)}function B(n){return A.apply(this,arguments)}function A(){return A=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/students/getAllStudentsByConditionsWithTotal?clientId=385",{params:a}).then(function(h){return{data:(0,g.we)(h.studentList,a),total:h.totalNum,success:!0}}));case 1:case"end":return t.stop()}},n)})),A.apply(this,arguments)}function o(n){return F.apply(this,arguments)}function F(){return F=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/students",{method:"post",data:a}));case 1:case"end":return t.stop()}},n)})),F.apply(this,arguments)}function de(n){return ie.apply(this,arguments)}function ie(){return ie=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/students/update",{method:"post",data:a}));case 1:case"end":return t.stop()}},n)})),ie.apply(this,arguments)}function d(n){return w.apply(this,arguments)}function w(){return w=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/students/".concat(a)));case 1:case"end":return t.stop()}},n)})),w.apply(this,arguments)}function me(n){return J.apply(this,arguments)}function J(){return J=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/students/".concat(a),{method:"delete"}));case 1:case"end":return t.stop()}},n)})),J.apply(this,arguments)}var pe={ended:function(a){return a.type===2&&a.endAt&&M()(a.startAt).isBefore(M()())},notStarted:function(a){return a.type===2&&M()().isBefore(a.startAt)},ongoing:function(a){return a.type===2&&!a.endAt&&M()(a.startAt).isBefore(M()())},video:function(a){return a.type===1}},q=function(a,p){return a.find(function(t){return pe[t](p)})};function Q(n){return Y.apply(this,arguments)}function Y(){return Y=l()(u()().mark(function n(a){var p,t,h;return u()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return p=a.classroomStatus,t=p===void 0?[]:p,h=s()(a,b),I.abrupt("return",(0,c.request)("/seller/api/course-classes?page=0&size=1000&clientId.equals=385&sort=startAt,desc&hasHomework=1",{params:h}).then(function(z){var ae=z.filter(function(he){return q(t,he)});return{data:(0,g.we)(ae,h),success:!0}}));case 2:case"end":return I.stop()}},n)})),Y.apply(this,arguments)}function le(n){return X.apply(this,arguments)}function X(){return X=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/course-classes/update",{method:"post",data:a}));case 1:case"end":return t.stop()}},n)})),X.apply(this,arguments)}function N(n){return Z.apply(this,arguments)}function Z(){return Z=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/course-classes/delete/".concat(a)));case 1:case"end":return t.stop()}},n)})),Z.apply(this,arguments)}function ce(n){return ee.apply(this,arguments)}function ee(){return ee=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/courses",{method:"post",data:m()({teacher:"",clientId:"385",client:{},isDelete:1},a)}));case 1:case"end":return t.stop()}},n)})),ee.apply(this,arguments)}function f(n){return W.apply(this,arguments)}function W(){return W=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/courses/update",{method:"post",data:a}));case 1:case"end":return t.stop()}},n)})),W.apply(this,arguments)}function fe(){return re.apply(this,arguments)}function re(){return re=l()(u()().mark(function n(){return u()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,c.request)("/seller/api/coursesget/getAllCoursesByConditionsWithTotal?clientId=385").then(function(t){return t.totalNum}));case 1:case"end":return p.stop()}},n)})),re.apply(this,arguments)}function te(n){return K.apply(this,arguments)}function K(){return K=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/courses/".concat(a)).then(function(h){var T=h.coverUrl,I=s()(h,ue);return m()({coverUrl:[{url:T}]},I)}));case 1:case"end":return t.stop()}},n)})),K.apply(this,arguments)}function O(n){return H.apply(this,arguments)}function H(){return H=l()(u()().mark(function n(a){var p;return u()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,c.request)("/seller/api/course-classes/".concat(a));case 2:return p=h.sent,h.abrupt("return",m()(m()({},p),{},{coverUrl:[{url:p.coverUrl}]}));case 4:case"end":return h.stop()}},n)})),H.apply(this,arguments)}function G(n){return j.apply(this,arguments)}function j(){return j=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/course-classes",{method:"post",data:m()({clientId:"385"},a)}));case 1:case"end":return t.stop()}},n)})),j.apply(this,arguments)}function ne(n){return D.apply(this,arguments)}function D(){return D=l()(u()().mark(function n(a){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,c.request)("/seller/api/course-classes/update",{method:"post",data:a}));case 1:case"end":return t.stop()}},n)})),D.apply(this,arguments)}},14971:function(ve,L,e){var V=e(79742),u=e(48764),U={str:{rn2br:function(r){return r.replace(/(\r\n)|(\n)/g,"<br>")},isNull:function(r){return r===null||typeof r=="undefined"},isEmpty:function(r){return U.str.isNull(r)?!0:typeof r!="string"?!1:r.length===0},isNotEmpty:function(r){return!U.str.isEmpty(r)},trim:function(r){return r.replace(/^\s+|\s+$/gm,"")},isChinaMobile:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return r.length===11},passwordLengthValid:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return r.length<=18&&r.length>=6},randomString:function(r){for(var s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=s.length,l="",g=0;g<r;g++)l+=s.charAt(Math.floor(Math.random()*i));return l}},obj:{isEmptyObj:function(r){return Object.keys(r).length===0},RemoveNulls:function(r){for(var s in r)if(Object.hasOwnProperty.call(r,s)){var i=r[s];(i===null||i==="")&&delete r[s]}return r}},date:{remainingTime:function(r){var s=parseInt((r/864e5).toString()),i=parseInt((r%(24*3600*1e3)/36e5).toString()),l=parseInt((r%36e5/6e4).toString()),g=parseInt((r%6e4/1e3).toString()),c="";return s>0&&(c=s+"\u5929"),i>0&&(c=c+(i+"\u65F6")),l>0&&(c=c+(l+"\u5206")),c=c+(g+"\u79D2"),c},remainingHour:function(r){var s=r>=0?"":"-",i=r>=0?r:r*-1,l=parseInt((i/3600).toString()),g=parseInt((i%3600/60).toString());return l>=0&&(s=s+(l+"\u65F6")),g>=0&&(s=s+(g+"\u5206")),s},format:function(r,s){if(!r||!s)return null;var i=s,l={"M+":r.getMonth()+1,"d+":r.getDate(),"h+":r.getHours()%12===0?12:r.getHours()%12,"H+":r.getHours(),"m+":r.getMinutes(),"s+":r.getSeconds(),"q+":Math.floor((r.getMonth()+3)/3),S:r.getMilliseconds()},g={0:"\u65E5",1:"\u4E00",2:"\u4E8C",3:"\u4E09",4:"\u56DB",5:"\u4E94",6:"\u516D"};/(y+)/.test(i)&&(i=i.replace(RegExp.$1,(r.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(i)&&(i=i.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"\u661F\u671F":"\u5468":"")+g[r.getDay()+""]));for(var c in l)new RegExp("("+c+")").test(i)&&(i=i.replace(RegExp.$1,RegExp.$1.length===1?l[c]:("00"+l[c]).substr((""+l[c]).length)));return i}},htmlstr:{html2dom:function(r){var s=document.createElement("div");return s.innerHTML=r,s}},url:{getDomainFromUrl:function(r){var s=r.indexOf("//"),i=r.indexOf("/",s+2);return i===-1?r.substring(s+2):r.substring(s+2,i)}},base64:{getBlobBydataURI:function(r,s){for(var i=atob((r||"").split(",")[1]),l=[],g=0;g<i.length;g++)l.push(i.charCodeAt(g));return new Blob([new Uint8Array(l)],{type:s})},encode:function(r){return V.fromByteArray(u.lW.from(r))}},array:{swap:function(r,s,i){return r[s]=r.splice(i,1,r[s])[0],r},remove:function(r,s){return isNaN(s)||s>r.length?[]:(r.splice(s,1),r)},insert:function(r,s,i){return r.splice(s,0,i),r},insertLast:function(r,s){return r.splice(r.length,0,s),r}}};L.Z=U},42350:function(ve,L,e){e.d(L,{Z:function(){return J}});var V=e(97983),u=e.n(V),U=e(40794),m=e.n(U),r=e(64129),s=e.n(r),i=e(12741),l=e.n(i),g=e(14971),c=e(19240),C=e(93045),M=e(82061),b=e(27496),ue=e(12461),S=e(85402),x=e(23613),B=e(24093),A=e(71577),o=e(30124),F=e(67294),de=e(20640),ie=e.n(de),d=e(85893),w="chatgpt_history",me=function(q){var Q,Y,le=q.open,X=q.handleClose,N=q.prompt,Z=(0,F.useRef)(null),ce=(0,F.useState)([]),ee=l()(ce,2),f=ee[0],W=ee[1],fe=(0,F.useState)(!1),re=l()(fe,2),te=re[0],K=re[1],O=(0,F.useState)(N),H=l()(O,2),G=H[0],j=H[1],ne=ue.ZP.useMessage(),D=l()(ne,2),n=D[0],a=D[1],p=function(){var v;f=(v=f)!==null&&v!==void 0?v:[];var R={index:f.length+1,createdAt:g.Z.date.format(new Date,"yyyy/MM/dd HH:mm:ss"),user:"admin",question:G,answer:"",isEnd:!1};f.push(R),W(s()(f))},t=function(){Z.current&&(console.log(Z),Z.current.scrollTop=Z.current.scrollHeight)},h=function(){localStorage.setItem(w,JSON.stringify(f))},T=function(v){var R=JSON.parse(v);f[f.length-1].answer=R.text,R.delta||(f[f.length-1].id=R.id,f[f.length-1].parentMessageId=R.parentMessageId,f[f.length-1].isEnd=!0,h(),K(!1)),W(s()(f)),t()},I=function(){var v;if(!(g.Z.str.isEmpty(G)||te)){var R=f?(v=f[f.length-1])===null||v===void 0?void 0:v.id:"";K(!0),p();var k=G;j("");try{(0,c.rz)(k,R,function($){var se=$.target,oe=se.responseText,Ee=oe.lastIndexOf(`
`,oe.length-2),ge=oe;Ee!==-1&&(ge=oe.substring(Ee));try{console.log(ge),T(ge)}catch(be){console.log(be)}})}catch($){T(JSON.stringify({id:"",parentMessageId:"",text:"\u7F51\u7EDC\u597D\u50CF\u51FA\u9519\u4E86\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}))}}},z=function(v){v.code==="Enter"&&!te&&I()},ae=function(){S.Z.confirm({style:{zIndex:"1002"},open:!0,title:"\u6E05\u7A7A\u8BB0\u5F55",content:"\u786E\u5B9A\u6E05\u7A7A\u548CChatGPT\u7684\u804A\u5929\u8BB0\u5F55\u5417",onOk:function(){var v=m()(u()().mark(function k(){return u()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:localStorage.removeItem(w),W([]),n.success("\u5DF2\u6E05\u7A7A\u8BB0\u5F55");case 3:case"end":return se.stop()}},k)}));function R(){return v.apply(this,arguments)}return R}()})},he=function(v){ie()(v),ue.ZP.success("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")};return(0,F.useEffect)(function(){j(N)},[N]),(0,F.useEffect)(function(){try{W(JSON.parse(localStorage.getItem(w)||""))}catch(E){localStorage.removeItem(w)}},[]),(0,F.useEffect)(function(){le&&t()},[le,f,f.length]),(0,d.jsxs)(d.Fragment,{children:[a,(0,d.jsxs)(x.Z,{className:"chatgpt-container",title:(0,d.jsx)("div",{className:"title",children:"ChatGPT\u5C0F\u52A9\u624B"}),placement:"left",width:600,closeIcon:(0,d.jsx)(d.Fragment,{}),onClose:X,maskClosable:!0,destroyOnClose:!0,open:le,style:{zIndex:"1000"},children:[(0,d.jsx)("ul",{ref:Z,children:((Q=f)===null||Q===void 0?void 0:Q.length)>0?f.map(function(E){var v=E.index,R=E.question,k=E.answer,$=E.createdAt,se=E.isEnd;return(0,d.jsxs)("li",{children:[(0,d.jsxs)("div",{className:"question",children:[(0,d.jsx)(B.C,{size:40,style:{minWidth:"40px",backgroundColor:"#1890FF",verticalAlign:"middle"},gap:1,children:"admin"}),(0,d.jsxs)("div",{className:"content",children:[(0,d.jsx)("div",{className:"time",children:$}),(0,d.jsx)("p",{children:R})]})]}),(0,d.jsxs)("div",{className:"answer",children:[(0,d.jsx)("img",{className:"avatar",src:"/icons/chatgpt-logo.jpg"}),(0,d.jsxs)("div",{className:"content",children:[(0,d.jsx)("div",{className:"time",children:$}),(0,d.jsxs)("p",{children:[k,(0,d.jsx)("br",{}),se&&k&&(0,d.jsx)(A.Z,{style:{float:"right"},type:"link",onClick:function(){return he(k)},children:"\u590D\u5236"})]})]})]})]},v)}):(0,d.jsxs)("div",{className:"empty-chat",children:[(0,d.jsx)(C.Z,{}),(0,d.jsx)("span",{children:"\u8BF7\u5411\u6211\u63D0\u95EE\u5427~"})]})}),(0,d.jsxs)("div",{className:"footer",children:[(0,d.jsx)(A.Z,{className:"clear-btn",disabled:te||!f||((Y=f)===null||Y===void 0?void 0:Y.length)<1,onClick:function(){return ae()},children:(0,d.jsx)(M.Z,{})}),(0,d.jsx)(o.Z,{autoFocus:!0,onFocus:function(){return t()},onKeyDown:function(v){return z(v)},value:G,onChange:function(v){return j(v.target.value)},className:"input",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u95EE\u9898"}),(0,d.jsx)(A.Z,{className:"send-btn",disabled:te,onClick:function(){return I()},icon:(0,d.jsx)(b.Z,{}),type:"primary",children:"\u53D1\u9001"})]})]},"left")]})},J=me}}]);

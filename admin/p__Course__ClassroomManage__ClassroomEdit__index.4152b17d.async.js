"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[411],{17880:function(pe,G,t){t.r(G);var X=t(97983),s=t.n(X),k=t(40794),h=t.n(k),q=t(11281),m=t.n(q),ee=t(12812),i=t.n(ee),y=t(12741),_=t.n(y),re=t(95855),D=t(10703),R=t(47745),te=t(736),ne=t(97072),L=t(25641),se=t(35991),T=t(99644),N=t(36275),O=t(95239),W=t(12461),b=t(71230),ue=t(15746),K=t(26713),ae=t(81961),F=t(71577),le=t(56318),oe=t(96486),ie=t.n(oe),E=t(67294),f=t(63154),x=t(99659),j=t(13714),S=t(26859),H=t(82061),Z=t(29141),_e=t(29158),v=t(93637),u=t(85893),$=function(){var C=(0,N.useParams)(),g=C.classroomId,M=C.courseId,B=g==="0"||!g,w=(0,E.useState)({}),z=_()(w,2),o=z[0],r=z[1],n=(0,E.useState)(!1),a=_()(n,2),e=a[0],l=a[1],Y=O.Z.useForm(),P=_()(Y,1),A=P[0],J=(0,x.Z)(j.se,{manual:!0}),Q=J.data,je=Q===void 0?{}:Q,Ce=J.run,fe=(0,N.useSearchParams)(),he=_()(fe,1),de=he[0],Ee=function(c,p){(0,f.Wi)(c).then(function(V){console.log(V),A.setFieldsValue(i()({},p,[Object.assign(c,{url:"https://ssl.cdn.maodouketang.com/".concat(V.key)})]))})},me,Pe=function(c,p){r({percent:0,_status:"active",url:""}),l(!0),me=(0,f._h)(c);var V=me.subscribe({error:function(U){console.log(U)},complete:function(U){r(m()(m()({},o),{},{percent:100,_status:"success",url:"https://ssl.cdn.maodouketang.com/".concat(U.key)})),W.ZP.success("\u4E0A\u4F20\u6210\u529F")},next:function(U){var Oe=U.total.percent.toFixed(0);r(m()(m()({},o),{},{url:"",percent:Oe,_status:"active"}))}});v.U.on("unsubscribe",function(){return V.unsubscribe()})},De=function(){var d=h()(s()().mark(function c(p){return s()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:(B?(0,j._I)(m()(m()({courseId:de.get("courseId"),roomId:de.get("roomId")},p),{},{coverUrl:p.coverUrl[0].url,choseUrl:o.url})):(0,j.$H)(m()(m()({},p),{},{coverUrl:p.coverUrl[0].url,choseUrl:o.url||""}))).then(function(U){W.ZP.success("".concat(B?"\u65B0\u589E":"\u7F16\u8F91","\u8BFE\u5802\u6210\u529F")),history.back()});case 1:case"end":return I.stop()}},c)}));return function(p){return d.apply(this,arguments)}}(),ve=function(){o.url?(l(!1),r({})):(v.U.emit("unsubscribe"),r(m()(m()({},o),{},{_status:"cancel",url:"-"})))},Me=function(c){e&&o._status==="active"&&(W.ZP.warn("\u6B63\u5728\u4E0A\u4F20"),c.stopPropagation(),c.nativeEvent.stopImmediatePropagation())};return(0,E.useEffect)(function(){B||(0,j.se)(g).then(function(d){A.setFieldsValue(d),r(m()(m()({},o),{},{url:d.choseUrl}))})},[g]),(0,E.useEffect)(function(){A.setFieldValue("courseId",M)},[M]),(0,E.useEffect)(function(){return function(){v.U.emit("unsubscribe")}},[]),(0,u.jsx)(re._z,{header:{title:"".concat(B?"\u65B0\u5EFA":"\u7F16\u8F91","\u8BFE\u5802"),onBack:function(){return history.back()}},style:{paddingBottom:"100px"},content:"\u8BFE\u7A0B\u53F7\uFF1A".concat(M),children:(0,u.jsxs)(D.A,{form:A,onFinish:De,layout:"horizontal",labelCol:{span:4},wrapperCol:{span:8},submitter:{render:function(c,p){return(0,u.jsx)(b.Z,{children:(0,u.jsx)(ue.Z,{span:14,offset:4,children:(0,u.jsx)(K.Z,{children:p})})})}},onReset:function(c){l(!1),r({})},children:[(0,u.jsx)(R.Z,{name:"className",label:"\u8BFE\u5802\u540D\u79F0",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:f.n0}),(0,u.jsx)(R.Z,{name:"courseId",label:"\u8BFE\u7A0B\u53F7",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:f.n0}),(0,u.jsx)(te.Z,{name:"coverUrl",label:"\u5C01\u9762\u56FE",max:1,fieldProps:{name:"file",listType:"picture-card"},colProps:{md:24,xl:12},action:function(c){return Ee(c,"coverUrl")},extra:"\u5EFA\u8BAE\u56FE\u7247\u6BD4\u4F8B\u4E3A16:9"}),(0,u.jsxs)(ne.Z,{name:"choseUrl",label:"\u8BFE\u7A0B\u89C6\u9891",colProps:{md:24,xl:12},children:[(0,u.jsx)(ae.Z,{maxCount:1,fileList:[],action:function(c){return Pe(c,"choseUrl")},children:(0,u.jsx)(F.Z,{onClick:Me,icon:(0,u.jsx)(S.Z,{}),children:"\u4E0A\u4F20"})}),e&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"360px"},children:[(0,u.jsx)(le.Z,{percent:o.percent,status:o._status}),(0,u.jsx)("a",{style:{width:"80px",marginLeft:"10px"},onClick:ve,children:o.url?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(H.Z,{style:{marginRight:"3px"}}),"\u6E05\u7A7A"]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Z.Z,{style:{marginRight:"3px"}})," \u53D6\u6D88"]})})]}),!o.url&&o._status==="active"&&(0,u.jsx)("span",{children:"\u6B63\u5728\u4E0A\u4F20"}),!!o.url&&o.url!=="-"&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"400px",gap:"30px",marginTop:"10px"},children:[(0,u.jsxs)("a",{href:o.url,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},target:"_blank",rel:"noreferrer",children:[(0,u.jsx)(_e.Z,{style:{marginRight:"10px"}}),o.url]}),!e&&(0,u.jsxs)("a",{style:{width:"150px"},onClick:function(){l(!1),r({}),console.log(o)},children:[(0,u.jsx)(H.Z,{style:{marginRight:"3px"}}),"\u6E05\u7A7A"]})]})]}),(0,u.jsx)(L.Z,{name:"type",label:"\u8BFE\u5802\u7C7B\u578B",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:f.n0,request:h()(s()().mark(function d(){return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",[{label:"\u4E92\u52A8\u76F4\u64AD\u8BFE",value:2},{label:"\u89C6\u5C4F\u4E0A\u4F20\u8BFE",value:1}]);case 1:case"end":return p.stop()}},d)}))}),(0,u.jsx)(R.Z,{name:"location",label:"\u4E0A\u8BFE\u5730\u70B9",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:f.n0}),(0,u.jsx)(se.Z,{name:"startAt",label:"\u4E0A\u8BFE\u65F6\u95F4",colProps:{md:24,xl:12},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:f.n0,fieldProps:{style:{width:"100%"}}}),(0,u.jsx)(T.Z,{name:"remark",label:"\u5907\u6CE8",colProps:{md:24,xl:24},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:f.n0}),(0,u.jsx)(O.Z.Item,{name:"id",noStyle:!0})]})})};G.default=$},13714:function(pe,G,t){t.d(G,{$H:function(){return z},EP:function(){return ae},Gr:function(){return ue},Hf:function(){return _e},No:function(){return ce},P6:function(){return H},Rq:function(){return f},Zy:function(){return se},_I:function(){return B},fZ:function(){return N},hS:function(){return W},qY:function(){return ie},qm:function(){return u},se:function(){return g},so:function(){return j},wA:function(){return ne}});var X=t(97983),s=t.n(X),k=t(11281),h=t.n(k),q=t(97548),m=t.n(q),ee=t(40794),i=t.n(ee),y=t(63154),_=t(36275),re=t(27484),D=t.n(re),R=["classroomStatus"],te=["coverUrl"];function ne(r){return L.apply(this,arguments)}function L(){return L=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/coursesget/getAllCoursesByConditionsWithTotal?clientId=385&isDelete=1",{params:h()({},n)}).then(function(l){return{data:(0,y.we)(l.courseList,n),total:l.totalNum,success:!0}}));case 1:case"end":return e.stop()}},r)})),L.apply(this,arguments)}function se(r){return T.apply(this,arguments)}function T(){return T=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/students/getAllStudentsByConditionsWithTotal?clientId=385",{params:n}).then(function(l){return{data:(0,y.we)(l.studentList,n),total:l.totalNum,success:!0}}));case 1:case"end":return e.stop()}},r)})),T.apply(this,arguments)}function N(r){return O.apply(this,arguments)}function O(){return O=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/students",{method:"post",data:n}));case 1:case"end":return e.stop()}},r)})),O.apply(this,arguments)}function W(r){return b.apply(this,arguments)}function b(){return b=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/students/update",{method:"post",data:n}));case 1:case"end":return e.stop()}},r)})),b.apply(this,arguments)}function ue(r){return K.apply(this,arguments)}function K(){return K=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/students/".concat(n)));case 1:case"end":return e.stop()}},r)})),K.apply(this,arguments)}function ae(r){return F.apply(this,arguments)}function F(){return F=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/students/".concat(n),{method:"delete"}));case 1:case"end":return e.stop()}},r)})),F.apply(this,arguments)}var le={ended:function(n){return n.type===2&&n.endAt&&D()(n.startAt).isBefore(D()())},notStarted:function(n){return n.type===2&&D()().isBefore(n.startAt)},ongoing:function(n){return n.type===2&&!n.endAt&&D()(n.startAt).isBefore(D()())},video:function(n){return n.type===1}},oe=function(n,a){return n.find(function(e){return le[e](a)})};function ie(r){return E.apply(this,arguments)}function E(){return E=i()(s()().mark(function r(n){var a,e,l;return s()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return a=n.classroomStatus,e=a===void 0?[]:a,l=m()(n,R),P.abrupt("return",(0,_.request)("/seller/api/course-classes?page=0&size=1000&clientId.equals=385&sort=startAt,desc&hasHomework=1",{params:l}).then(function(A){var J=A.filter(function(Q){return oe(e,Q)});return{data:(0,y.we)(J,l),success:!0}}));case 2:case"end":return P.stop()}},r)})),E.apply(this,arguments)}function f(r){return x.apply(this,arguments)}function x(){return x=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/course-classes/update",{method:"post",data:n}));case 1:case"end":return e.stop()}},r)})),x.apply(this,arguments)}function j(r){return S.apply(this,arguments)}function S(){return S=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/course-classes/delete/".concat(n)));case 1:case"end":return e.stop()}},r)})),S.apply(this,arguments)}function H(r){return Z.apply(this,arguments)}function Z(){return Z=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/courses",{method:"post",data:h()({teacher:"",clientId:"385",client:{},isDelete:1},n)}));case 1:case"end":return e.stop()}},r)})),Z.apply(this,arguments)}function _e(r){return v.apply(this,arguments)}function v(){return v=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/courses/update",{method:"post",data:n}));case 1:case"end":return e.stop()}},r)})),v.apply(this,arguments)}function u(){return $.apply(this,arguments)}function $(){return $=i()(s()().mark(function r(){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,_.request)("/seller/api/coursesget/getAllCoursesByConditionsWithTotal?clientId=385").then(function(e){return e.totalNum}));case 1:case"end":return a.stop()}},r)})),$.apply(this,arguments)}function ce(r){return C.apply(this,arguments)}function C(){return C=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/courses/".concat(n)).then(function(l){var Y=l.coverUrl,P=m()(l,te);return h()({coverUrl:[{url:Y}]},P)}));case 1:case"end":return e.stop()}},r)})),C.apply(this,arguments)}function g(r){return M.apply(this,arguments)}function M(){return M=i()(s()().mark(function r(n){var a;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,_.request)("/seller/api/course-classes/".concat(n));case 2:return a=l.sent,l.abrupt("return",h()(h()({},a),{},{coverUrl:[{url:a.coverUrl}]}));case 4:case"end":return l.stop()}},r)})),M.apply(this,arguments)}function B(r){return w.apply(this,arguments)}function w(){return w=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/course-classes",{method:"post",data:h()({clientId:"385"},n)}));case 1:case"end":return e.stop()}},r)})),w.apply(this,arguments)}function z(r){return o.apply(this,arguments)}function o(){return o=i()(s()().mark(function r(n){return s()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/seller/api/course-classes/update",{method:"post",data:n}));case 1:case"end":return e.stop()}},r)})),o.apply(this,arguments)}}}]);

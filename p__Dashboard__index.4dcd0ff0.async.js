"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[181],{14653:function(z,L,e){e.d(L,{N:function(){return B},w:function(){return x}});var N=e(97983),v=e.n(N),K=e(11281),r=e.n(K),b=e(40794),R=e.n(b),C=e(4638),$=e(63154),y=e(2641),H=e(30381),Z=e.n(H);function B(f){return j.apply(this,arguments)}function j(){return j=R()(v()().mark(function f(t){return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,y.request)("/analysis/api/room-actions/getRoomActionsWithTotalNumByConditionsTime",{params:r()(r()({clientId:385},t),{},{sort:"id,desc"})}).then(function(l){return{data:(0,$.we)(l.roomActionList,t),total:l.totalNum,success:!0}}));case 1:case"end":return n.stop()}},f)})),j.apply(this,arguments)}function x(f){return M.apply(this,arguments)}function M(){return M=R()(v()().mark(function f(t){var o,n,l;return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,y.request)("/analysis/api/room-actions/getRoomActionsWithTotalNumByConditionsTime",{params:r()(r()({clientId:385},t),{},{sort:"id,desc",actionType:C.v9.PLAYBACK.value})});case 2:return o=u.sent.totalNum,u.next=5,(0,y.request)("/analysis/api/room-actions/getRoomActionsWithTotalNumByConditionsTime",{params:r()(r()({clientId:385},t),{},{sort:"id,desc",actionType:C.v9.PLAYBACK.value,page:0,size:o})});case 5:return n=u.sent,l=E(n.roomActionList),u.abrupt("return",{data:(0,$.we)(l,t),total:l.length,success:!0});case 8:case"end":return u.stop()}},f)})),M.apply(this,arguments)}var E=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=[];return t.forEach(function(n){var l=n.courseId,p=n.courseClassId,u=n.userId,_=n.description,c=o.findIndex(function(g){return g.courseId===l&&g.courseClassId===p&&g.userId===u}),A=parseInt(_);c<0?o.push(r()(r()({},n),{},{viewNum:1,description:A||0})):(o[c].viewNum++,o[c].description+=A||0)}),o}},4638:function(z,L,e){e.d(L,{A9:function(){return H},A_:function(){return r},IJ:function(){return x},YK:function(){return B},fx:function(){return Z},hH:function(){return M},hY:function(){return R},mJ:function(){return y},pJ:function(){return j},uJ:function(){return $},v9:function(){return K}});var N=e(12741),v=e.n(N),K={REGISTER:{label:"\u62A5\u540D",value:"REGISTER"},PLAYBACK:{label:"\u89C2\u770B\u56DE\u653E",value:"PLAYBACK"},ENTER:{label:"\u8FDB\u5165\u8BFE\u5802",value:"ENTER"},EXIT:{label:"\u9000\u51FA\u8BFE\u5802",value:"EXIT"},START_CLASS:{label:"\u4E0A\u8BFE",value:"START_CLASS"},STOP_CLASS:{label:"\u4E0B\u8BFE",value:"STOP_CLASS"},CHATGPT:{label:"CHATGPT",value:"CHATGPT"},RECEIVED_STREAMS:{label:"\u63A5\u6536\u6D41",value:"RECEIVED_STREAMS"},JOIN:{label:"\u7B7E\u5230",value:"JOIN"},CHAT:{label:"\u804A\u5929",value:"CHAT"},ON_SCREEN:{label:"\u4E0A\u5C4F",value:"ON_SCREEN"},OFF_SCREEN:{label:"\u4E0B\u5C4F",value:"OFF_SCREEN"},ALIVE:{label:"\u5728\u7EBF",value:"ALIVE"},ERROR:{label:"\u62A5\u9519",value:"ERROR"},TIMEOUT:{label:"\u8D85\u65F6",value:"TIMEOUT"},SELECT:{label:"\u9009\u62E9",value:"SELECT"}},r={NAME:"call",TITLE:"title",DATE:"date",CONTENT:"content",ROLE:"role",NOTE:"note"},b=[r.NAME,r.TITLE,r.DATE,r.NOTE],R=[{value:1641392,label:"\u4E0A\u8BFE\u901A\u77E51",params:b,getContent:function(f){var t=v()(f,5),o=t[0],n=o===void 0?"":o,l=t[1],p=l===void 0?"":l,u=t[2],_=u===void 0?"":u,c=t[3],A=c===void 0?"":c,g=t[4],I=g===void 0?"":g;return"\u3010".concat(n,"\u3011").concat(p,"\uFF0C\u60A8\u62A5\u540D\u7684\u8BFE\u7A0B ").concat(_," \u5373\u5C06\u5F00\u59CB\uFF0C\u4E0A\u8BFE\u65F6\u95F4\u662F").concat(A," \uFF0C\u8BF7\u51C6\u65F6\u53C2\u52A0\u3002\u5907\u6CE8\uFF1A").concat(I," \u3002 \u56DET\u9000\u8BA2")}},{value:1646915,label:"\u4E0A\u8BFE\u901A\u77E52",params:b,getContent:function(f){var t=v()(f,5),o=t[0],n=o===void 0?"":o,l=t[1],p=l===void 0?"":l,u=t[2],_=u===void 0?"":u,c=t[3],A=c===void 0?"":c,g=t[4],I=g===void 0?"":g;return"\u3010".concat(n,"\u3011").concat(p,"\u60A8\u597D,").concat(_,"\u5373\u5C06\u5F00\u8BB2, \u4E0A\u8BFE\u65F6\u95F4").concat(A,",\u5907\u6CE8\uFF1A").concat(I," \u3002 \u56DET\u9000\u8BA2")}},{value:1644970,label:"\u6D3B\u52A8\u901A\u77E5",params:[r.NAME,r.TITLE,r.ROLE,r.DATE,r.NOTE],getContent:function(f){var t=v()(f,6),o=t[0],n=o===void 0?"":o,l=t[1],p=l===void 0?"":l,u=t[2],_=u===void 0?"":u,c=t[3],A=c===void 0?"":c,g=t[4],I=g===void 0?"":g,G=t[5],V=G===void 0?"":G;return"\u3010".concat(n,"\u3011\u6E29\u99A8\u63D0\u9192\uFF1A").concat(p,"\u5373\u5C06\u4E3E\u529E").concat(_,"\uFF0C\u672C\u6B21\u6D3B\u52A8\u9762\u5411").concat(A,"\uFF0C\u62A5\u540D\u65F6\u95F4\u622A\u6B62\u5230").concat(I,"\uFF0C\u6B22\u8FCE\u53C2\u52A0\u3002\u5907\u6CE8\uFF1A").concat(V," \u3002 \u56DET\u9000\u8BA2")}},{value:1641362,label:"\u8BFE\u7A0B\u62A5\u540D",params:[r.TITLE,r.NAME,r.DATE,r.NOTE],getContent:function(f){var t=v()(f,5),o=t[0],n=o===void 0?"":o,l=t[1],p=l===void 0?"":l,u=t[2],_=u===void 0?"":u,c=t[3],A=c===void 0?"":c,g=t[4],I=g===void 0?"":g;return"\u3010".concat(n,"\u3011\u60A8\u597D\uFF0C\u300A").concat(p,"\u300B\u5373\u5C06\u5F00\u8BB2\uFF0C\u7531 ").concat(_," \u4EB2\u4E34\u6388\u8BFE\uFF0C\u62A5\u540D\u65F6\u95F4\u622A\u6B62\u5230").concat(A,"\uFF0C \u4E0D\u8981\u9519\u8FC7\u54E6! \u5907\u6CE8\uFF1A ").concat(I," \u3002 \u56DET\u9000\u8BA2")}},{value:1981363,label:"\u5F00\u73ED\u901A\u77E5",params:[r.NAME,r.TITLE,r.CONTENT,r.NOTE],getContent:function(f){var t=v()(f,5),o=t[0],n=o===void 0?"":o,l=t[1],p=l===void 0?"":l,u=t[2],_=u===void 0?"":u,c=t[3],A=c===void 0?"":c,g=t[4],I=g===void 0?"":g;return"\u3010".concat(n,"\u3011").concat(p,",").concat(_,"\u5373\u5C06\u5F00\u59CB\uFF0C").concat(A," \u3002\u5907\u6CE8\uFF1A").concat(I," \u3002\u62D2\u6536\u8BF7\u56DE\u590DR")}},{value:1981205,label:"\u4E0A\u8BFE\u524D\u901A\u77E5",params:[r.NAME,r.TITLE,r.NOTE],getContent:function(f){var t=v()(f,4),o=t[0],n=o===void 0?"":o,l=t[1],p=l===void 0?"":l,u=t[2],_=u===void 0?"":u,c=t[3],A=c===void 0?"":c;return"\u3010".concat(n,"\u3011").concat(p,"\uFF0C\u60A8\u62A5\u540D\u7684\u8BFE\u7A0B ").concat(_," \uFF0C\u8BF7\u51C6\u65F6\u53C2\u52A0\u3002\u5907\u6CE8\uFF1A").concat(A," \u3002")}}],C=function(E){return E.STUDENT="1",E.TEACHER="2",E.VISITOR="3",E.TUTOR="4",E.ADMIN="5",E.PARENT="6",E}({}),$=[{value:C.TEACHER,color:"geekblue",label:"\u6559\u5E08"},{value:C.TUTOR,color:"blue",label:"\u52A9\u6559"},{value:C.STUDENT,color:"cyan",label:"\u5B66\u751F"},{value:C.ADMIN,color:"red",label:"\u7BA1\u7406\u5458"}],y={NONE:"0",ONLY_ROOM:"1",ONLY_PLAYBACK:"2",ALL_RIGNHT:"3"},H={ROOM:{name:"ROOM",label:"verify_room",value:1},PLAYBACK:{name:"PLAYBACK",label:"verify_playback",value:2}},Z=function(f,t,o){var n=o?t:t*-1;return(parseInt(f)+n).toString()},B=["\u5927\u4E00","\u5927\u4E8C","\u5927\u4E09","\u5927\u56DB","\u7855\u58EB\u7814\u7A76\u751F","\u535A\u58EB\u7814\u7A76\u751F","\u5927\u5B66\u8001\u5E08","\u516C\u53F8\u6280\u672F\u5DE5\u7A0B\u5E08","\u5176\u4ED6"],j=[{value:"\u672A\u8BA2\u9605\u901A\u77E5",label:"\u4E0D\u8BA2\u9605\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u77ED\u4FE1\u901A\u77E5",label:"\u8BA2\u9605\u77ED\u4FE1\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u7535\u8BDD\u901A\u77E5",label:"\u8BA2\u9605\u7535\u8BDD\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u5168\u90E8\u901A\u77E5",label:"\u8BA2\u9605\u5168\u90E8\u901A\u77E5"}],x=/^(\+86|86)?1[3-9]\d{9}$|^(\+886|0)9\d{8}$/,M=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/},68632:function(z,L,e){e.d(L,{d:function(){return N}});var N=function(v){return v.STUDENT="1",v.TEACHER="2",v.VISITOR="3",v.TUTOR="4",v.ADMIN="5",v.PARENT="6",v}({})},74419:function(z,L,e){e.r(L),e.d(L,{default:function(){return st}});var N=e(11281),v=e.n(N),K=e(64129),r=e.n(K),b=e(12741),R=e.n(b),C=e(67294),$=e(97983),y=e.n($),H=e(40794),Z=e.n(H),B=e(2641);function j(){return x.apply(this,arguments)}function x(){return x=Z()(y()().mark(function O(){return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,B.request)("/analysis/api/room-timesget/getTotalSummaryDetailsByClientId?clientId=385"));case 1:case"end":return i.stop()}},O)})),x.apply(this,arguments)}function M(){return E.apply(this,arguments)}function E(){return E=Z()(y()().mark(function O(){return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,B.request)("/order/api/order-agencies/getOrderAgenciesByConditions?clientId=385&size=200&sort=id,desc"));case 1:case"end":return i.stop()}},O)})),E.apply(this,arguments)}function f(){return t.apply(this,arguments)}function t(){return t=Z()(y()().mark(function O(){return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,B.request)("/analysis/api/day-summaries/getTotalSummaryCount?clientId=483"));case 1:case"end":return i.stop()}},O)})),t.apply(this,arguments)}var o=e(95855),n=e(21448),l=e(44784),p=e(84031),u=e(14971),_=e(68632),c=e(14653),A=e(4638),g=e(57778),I=function(h){var i=((h==null?void 0:h.daySummaryList)||[]).toReversed();return{title:{text:"\u8FD115\u5929\u6D88\u8D39\u65F6\u957F: ".concat(u.Z.date.remainingHour(h==null?void 0:h.totalTimeLong))},tooltip:{formatter:""},xAxis:{type:"category",data:i.map(function(F){return F.sumDay})},yAxis:{type:"value",interval:(h==null?void 0:h.totalTimeLong)/20,axisLabel:{formatter:function(T){return Math.floor(T/3600)+"\u65F6"}}},series:[{data:i.map(function(F){return F.timeLong}),type:"bar",smooth:!0,label:{show:!0,position:"top",formatter:function(T){return(Math.floor(T.data/3600)>0?Math.floor(T.data/3600):(T.data/3600).toFixed(1))+"\u65F6"}},tooltip:{valueFormatter:function(T){return Math.floor(T/3600)+"\u5C0F\u65F6"}}}]}},G=function(h){return{xAxis:{type:"category",data:h.map(function(i){return i.date})},yAxis:{type:"value"},grid:{left:"3%",right:"4%",top:"5%",containLabel:!0},tooltip:{formatter:""},series:[{data:h.map(function(i){return i.num}),type:"line",radius:"60%",label:{show:!0,position:"top"}}]}},V=function(h){var i=h.sort(function(T,S){return T.value-S.value}),F=h.reduce(function(T,S){return T+S.value},0);return i.length>0?{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},valueFormatter:function(S){return(S/F*100).toFixed(2)+"%"}},legend:{},grid:{left:"1%",right:"8%",top:"5%",containLabel:!0},xAxis:{type:"value",axisLabel:{formatter:function(S){return S+"\u4EBA"}}},yAxis:{type:"category",data:i.map(function(T){return T.name})},visualMap:{max:i[i.length-1].value,min:i[0].value,dimension:0,show:!1,inRange:{color:["#67BDF9","#4F6DEE"]}},series:[{type:"bar",data:i.map(function(T){return T.value}),radius:"60%",label:{show:!0,position:"right",formatter:function(S){return S.value+"\u4EBA"}}}]}:{}},ot=e(74763),it=e(71230),X=e(15746),Q=e(62986),a=e(85893),w=7,lt=function(){var h=(0,C.useState)([]),i=R()(h,2),F=i[0],T=i[1],S=(0,B.useRequest)(j),U=S.data,ct=(0,C.useState)({roomActionList:[],totalNum:0}),k=R()(ct,2),dt=k[0],mt=k[1],vt=(0,C.useState)([]),q=R()(vt,2),ft=q[0],Et=q[1],At=(0,C.useState)(),tt=R()(At,2),J=tt[0],gt=tt[1],ht=(0,C.useState)([]),et=R()(ht,2),nt=et[0],Tt=et[1],pt=(0,C.useState)([]),ut=R()(pt,2),Ct=ut[0],_t=ut[1],Ft=(0,B.useSelector)(function(s){return s.courses}),Y=Ft.courses,Dt=(0,B.useSelector)(function(s){return s.students}),W=Dt.students,yt=W.filter(function(s){return s.status===_.d.TEACHER||s.registers.findIndex(function(d){return d.status===_.d.TEACHER})>-1}),Rt=function(d){var m=d.reduce(function(D,P){var at=u.Z.date.format(new Date(P.actionTime),"yyyy-MM-dd").slice(5),rt=D.find(function(Bt){return Bt.date===at});return rt?rt.num++:D.push({date:at,num:1}),D},[]);Et(m.reverse())},It=function(d){var m=new Date,D=60*60*24*1e3*w;(0,c.N)({actionType:d,startTime:new Date(m.getTime()-D),endTime:m,size:1e4}).then(function(P){d===A.v9.REGISTER.value&&(mt({roomActionList:P.data,totalNum:P.total}),Rt(P.data))}),(0,g.QO)({startTime:new Date(m.getTime()-D),endTime:m,size:2e3}).then(function(P){gt(P)})};(0,C.useEffect)(function(){M().then(function(s){var d=0;s.forEach(function(m){d+=m.minutes*60}),F[0]={title:"\u8D2D\u4E70\u603B\u65F6\u957F",value:u.Z.date.remainingHour(d),desc:"\u5DF2\u8D2D\u5957\u9910\u5305\uFF1A".concat(s.length,"\u4E2A")},f().then(function(m){F[1]={title:"\u6D88\u8D39\u603B\u65F6\u957F",value:u.Z.date.remainingHour(m.totalTimeLong),desc:"\u65E5\u5E73\u5747\u91CF:".concat(u.Z.date.remainingHour(m.totalTimeLong/m.days))},F[2]={title:"\u5269\u4F59\u65F6\u957F",value:u.Z.date.remainingHour(d-m.totalTimeLong),desc:"\u9884\u8BA1\u53EF\u7528:".concat(d-m.totalTimeLong>0?parseInt(((d-m.totalTimeLong)/(m.totalTimeLong/m.days)).toString()):0,"\u5929")},T(r()(F))})}),It(A.v9.REGISTER.value)},[]),(0,C.useEffect)(function(){if(J&&Y.length>0){var s=[];J.roomTimeList.forEach(function(d){if(s.findIndex(function(D){return D.roomId===d.roomId})<0){var m=Y.find(function(D){return D.roomId===d.roomId});s.push({title:m.title,roomId:m.roomId,count:m.applyCount||0})}}),Tt([].concat(s))}},[J,Y]),(0,C.useEffect)(function(){if(W.length>0){var s=[];A.YK.forEach(function(d){var m=W.filter(function(D){return D.registers[D.registers.length-1].age===d}).length;s.push({value:m,name:d})}),_t(s)}},[W]);var St=[{title:"\u65E5\u671F",dataIndex:"sumDay"},{title:"\u4E0A\u8BFE\u6559\u5BA4\u603B\u6570",dataIndex:"roomNum"},{title:"\u5B66\u751F\u603B\u4EBA\u6570",dataIndex:"studentNum"},{title:"\u6559\u5E08\u603B\u4EBA\u6570",dataIndex:"teacherNum"},{title:"\u6D88\u8017\u603B\u65F6\u957F",dataIndex:"timeLong"}].map(function(s){return v()(v()({},s),{},{align:"center"})});return(0,a.jsx)("div",{className:"dashboard",children:(0,a.jsxs)(o._z,{children:[(0,a.jsx)(n.Z,{direction:"row",ghost:!0,gutter:[8,8],style:{margin:0},children:F.map(function(s,d){return(0,a.jsx)(n.Z,{colSpan:6,title:(0,a.jsx)(ot.Z,{title:s.title,value:s.value}),children:(0,a.jsxs)(it.Z,{style:{color:"#409eff"},justify:"space-between",children:[(0,a.jsx)(X.Z,{children:s.desc}),(0,a.jsx)(X.Z,{style:{cursor:"pointer"},children:d===2?"\u53BB\u5145\u503C":"\u67E5\u770B\u8BE6\u60C5"})]})},s.title)})}),(0,a.jsxs)("ul",{className:"num-overview",children:[(0,a.jsxs)("li",{children:["\u8BFE\u7A0B\u603B\u6570 ",(0,a.jsx)("span",{className:"num",children:Y.length})]}),(0,a.jsxs)("li",{children:["\u8001\u5E08\u603B\u6570 ",(0,a.jsx)("span",{className:"num",children:yt.length})]}),(0,a.jsxs)("li",{children:["\u5B66\u751F\u603B\u6570 ",(0,a.jsx)("span",{className:"num",children:W.length})]}),(0,a.jsxs)("li",{children:["\u8FD1",w,"\u5929\u5B66\u751F\u62A5\u540D\u4EBA\u6570 ",(0,a.jsx)("span",{className:"num",children:dt.totalNum})]})]}),(0,a.jsxs)(n.Z,{direction:"row",ghost:!0,gutter:[8,8],children:[(0,a.jsx)(n.Z,{colSpan:8,title:"\u8FD130\u5929\u76F4\u64AD\u8BFE\u7A0B",children:(0,a.jsx)("ul",{className:"live-course",children:nt.length>0?nt.map(function(s,d){return(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"title",children:"".concat(d+1,"\u3001").concat(s.title)}),(0,a.jsxs)("span",{className:"num",children:[s.count," \u4EBA"]})]},d)}):(0,a.jsx)(Q.Z,{image:Q.Z.PRESENTED_IMAGE_SIMPLE})})}),(0,a.jsx)(n.Z,{colSpan:8,title:"\u5B66\u751F\u5B66\u5386\u5360\u6BD4",children:(0,a.jsx)(p.Z,{option:V(Ct)})}),(0,a.jsx)(n.Z,{colSpan:8,title:"\u8FD17\u5929\u62A5\u540D\u4EBA\u6570",children:(0,a.jsx)(p.Z,{option:G(ft)})})]}),(0,a.jsxs)(n.Z,{direction:"row",ghost:!0,gutter:[8,8],style:{marginTop:30},children:[(0,a.jsx)(n.Z,{colSpan:14,children:(0,a.jsx)(p.Z,{option:I(U),style:{height:"447px",width:"100%"}})}),(0,a.jsx)(n.Z,{colSpan:10,children:(0,a.jsx)(l.Z,{rowKey:"id",style:{height:"447px",width:"100%"},pagination:!1,toolBarRender:!1,dataSource:U==null?void 0:U.daySummaryList,search:!1,columns:St,scroll:{y:360}})})]})]})})},st=lt}}]);

"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[335],{91681:function(oe,$,e){e.d($,{UW:function(){return b}});var O=e(10703),b=O.A.Group},71694:function(oe,$,e){e.d($,{Z:function(){return le}});var O=e(11281),b=e.n(O),q=e(99399),W=e.n(q),_=e(97983),c=e.n(_),ee=e(40794),F=e.n(ee),w=e(67294),V=e(12461),re=e(63154),ae=e(71167),L=e.n(ae),x=e(9128),te=e.n(x),de=function(E){for(var o=E.split(","),I=o[0].match(/:(.\*?);/)[1],y=atob(o[1]),B=y.length,T=new Uint8Array(B);B--;)T[B]=y.charCodeAt(B);return new Blob([T],{type:I})},G=function(E){for(var o=atob(E),I=[],y=0;y<o.length;y+=512){for(var B=o.slice(y,y+512),T=new Array(B.length),S=0;S<B.length;S++)T[S]=B.charCodeAt(S);var P=new Uint8Array(T);I.push(P)}var N=new File(I,"upload.jpg",{type:"image/jpeg"});return N},z=function(E){var o=/<[^>]+>/g;return o.test(E)},A=e(85893);ae.Quill.register("modules/imageResize",te());var ce=/<img [^>]*src=['"]data:image([^'"]+)[^>]*>/,j={HTML:"text/html",TEXT:"text/plain",IMAGE:"image"},ne=function(E){var o=(0,w.useRef)(null),I=function(){var f=F()(c()().mark(function s(){var l;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:l=document.createElement("input"),l.setAttribute("type","file"),l.setAttribute("accept","image/*"),l.click(),l.onchange=F()(c()().mark(function i(){var u;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:u=l.files[0],B(u);case 2:case"end":return v.stop()}},i)}));case 5:case"end":return a.stop()}},s)}));return function(){return f.apply(this,arguments)}}(),y=function(){var f=F()(c()().mark(function s(l){var d,a,i;return c()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d=V.ZP.loading("\u56FE\u7247\u4E0A\u4F20\u4E2D...",0),n.prev=1,n.next=4,(0,re.Wi)(l);case 4:return a=n.sent,d(),i="https://ssl.cdn.maodouketang.com/".concat(a.key),n.abrupt("return",i);case 10:n.prev=10,n.t0=n.catch(1),d(),V.ZP.error("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 14:case"end":return n.stop()}},s,null,[[1,10]])}));return function(l){return f.apply(this,arguments)}}(),B=function(){var f=F()(c()().mark(function s(l){var d,a,i,u;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,y(l);case 2:a=v.sent,i=o==null||(d=o.current)===null||d===void 0?void 0:d.getEditor(),u=i.getSelection().index,i.insertEmbed(u,"image",a),i.setSelection(u+1);case 7:case"end":return v.stop()}},s)}));return function(l){return f.apply(this,arguments)}}(),T=(0,w.useMemo)(function(){return{toolbar:{container:[["bold","italic","underline","strike","blockquote","code-block"],[{align:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{background:["rgb(  0,   0,   0)","rgb(230,   0,   0)","rgb(255, 153,   0)","rgb(255, 255,   0)","rgb(  0, 138,   0)","rgb(  0, 102, 204)","rgb(153,  51, 255)","rgb(255, 255, 255)","rgb(250, 204, 204)","rgb(255, 235, 204)","rgb(255, 255, 204)","rgb(204, 232, 204)","rgb(204, 224, 245)","rgb(235, 214, 255)","rgb(187, 187, 187)","rgb(240, 102, 102)","rgb(255, 194, 102)","rgb(255, 255, 102)","rgb(102, 185, 102)","rgb(102, 163, 224)","rgb(194, 133, 255)","rgb(136, 136, 136)","rgb(161,   0,   0)","rgb(178, 107,   0)","rgb(178, 178,   0)","rgb(  0,  97,   0)","rgb(  0,  71, 178)","rgb(107,  36, 178)","rgb( 68,  68,  68)","rgb( 92,   0,   0)","rgb(102,  61,   0)","rgb(102, 102,   0)","rgb(  0,  55,   0)","rgb(  0,  41, 102)","rgb( 61,  20,  10)"]}],[{color:["rgb(  0,   0,   0)","rgb(230,   0,   0)","rgb(255, 153,   0)","rgb(255, 255,   0)","rgb(  0, 138,   0)","rgb(  0, 102, 204)","rgb(153,  51, 255)","rgb(255, 255, 255)","rgb(250, 204, 204)","rgb(255, 235, 204)","rgb(255, 255, 204)","rgb(204, 232, 204)","rgb(204, 224, 245)","rgb(235, 214, 255)","rgb(187, 187, 187)","rgb(240, 102, 102)","rgb(255, 194, 102)","rgb(255, 255, 102)","rgb(102, 185, 102)","rgb(102, 163, 224)","rgb(194, 133, 255)","rgb(136, 136, 136)","rgb(161,   0,   0)","rgb(178, 107,   0)","rgb(178, 178,   0)","rgb(  0,  97,   0)","rgb(  0,  71, 178)","rgb(107,  36, 178)","rgb( 68,  68,  68)","rgb( 92,   0,   0)","rgb(102,  61,   0)","rgb(102, 102,   0)","rgb(  0,  55,   0)","rgb(  0,  41, 102)","rgb( 61,  20,  10)"]}],["clean"]],handlers:{image:I},history:{delay:500,maxStack:100,userOnly:!0}},imageResize:{displayStyles:{backgroundColor:"black",border:"none",color:"white"},modules:["Resize"]}}},[]),S=function(){var f=F()(c()().mark(function s(l){var d,a,i,u,n,v,Z,R,D,g;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(l.preventDefault(),d=l.clipboardData||window.clipboardData,!d){p.next=28;break}if(a=d.items,console.log("items=>",a),!a){p.next=28;break}i=Array.from(a),u="",n=i.findIndex(function(C){return C.type===j.TEXT})!==-1,v=i.findIndex(function(C){return C.type===j.HTML})!==-1,Z=i.findIndex(function(C){return C.type.indexOf(j.IMAGE)!==-1})!==-1,n&&!v&&(u=j.TEXT),Z&&!v&&(u=j.IMAGE),v&&(u=j.HTML),R=0;case 15:if(!(R<a.length)){p.next=28;break}if(D=a[R],!(u!=="image"&&D.type===u)){p.next=21;break}D.getAsString(function(){var C=F()(c()().mark(function X(K){var Q;return c()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,P(K);case 2:Q=M.sent,setTimeout(function(){var H,J=o==null||(H=o.current)===null||H===void 0?void 0:H.getEditor(),se=J.getSelection().index;console.log(J),J.clipboard.dangerouslyPasteHTML(se,Q)},0);case 4:case"end":return M.stop()}},X)}));return function(X){return C.apply(this,arguments)}}()),p.next=25;break;case 21:if(D.type.indexOf(u)===-1){p.next=25;break}return g=D.getAsFile(),p.next=25,B(g);case 25:R++,p.next=15;break;case 28:case"end":return p.stop()}},s)}));return function(l){return f.apply(this,arguments)}}(),P=function(){var f=F()(c()().mark(function s(l){var d,a,i,u,n,v,Z,R;return c()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:g.prev=0,d=new DOMParser,a=d.parseFromString(l,"text/html"),i=a.getElementsByTagName("img"),u=0;case 5:if(!(u<i.length)){g.next=17;break}if(n=i[u],!n.src.startsWith("data:image")){g.next=14;break}return v=n.src.split(",")[1],Z=G(v),g.next=12,y(Z);case 12:R=g.sent,n.src=R;case 14:u++,g.next=5;break;case 17:return g.abrupt("return",a.documentElement.outerHTML);case 20:return g.prev=20,g.t0=g.catch(0),console.log("uploadImgInPasteText\u51FA\u9519\u4E86",g.t0),g.abrupt("return",l);case 24:case"end":return g.stop()}},s,null,[[0,20]])}));return function(l){return f.apply(this,arguments)}}(),N=new MutationObserver(function(f){var s=W()(f),l;try{for(s.s();!(l=s.n()).done;){var d=l.value;if(d.type==="attributes"&&d.attributeName==="width"){var a=d.target;a.style=null;var i=a.parentNode.offsetWidth,u=100/i*a.width;a.style.width="".concat(u.toFixed(2),"%")}}}catch(n){s.e(n)}finally{s.f()}}),r={attributes:!0,childList:!1,subtree:!1};return(0,w.useEffect)(function(){console.log(o),o.current.editor.container.addEventListener("paste",S),o.current.editor.root.addEventListener("DOMSubtreeModified",function(f){if(f.target.tagName==="IMG"){var s=f.target;N.observe(s,r)}},!0)},[]),(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(L(),b()({ref:o,theme:"snow",placeholder:"\u8BF7\u8F93\u5165",modules:T,style:{height:E.height}},E))})},le=ne},76440:function(oe,$,e){e.r($),e.d($,{default:function(){return s}});var O=e(97983),b=e.n(O),q=e(11281),W=e.n(q),_=e(40794),c=e.n(_),ee=e(12741),F=e.n(ee),w=e(14971),V=e(64255),re=e(71694),ae=e(19240),L=e(13714),x=e(63154),te=e(95855),de=e(10703),G=e(47745),z=e(91681),A=e(25641),ce=e(99644),j=e(60014),ne=e(736),le=e(97072),U=e(2641),E=e(95239),o=e(12461),I=e(71230),y=e(15746),B=e(26713),T=e(71577),S=e(96486),P=e(67294),N=e(71167),r=e(85893),f=function(){var d=(0,U.useParams)(),a=d.courseId,i=E.Z.useForm(),u=F()(i,1),n=u[0],v=(0,P.useState)(!1),Z=F()(v,2),R=Z[0],D=Z[1],g=(0,P.useState)(!1),ue=F()(g,2),p=ue[0],C=ue[1],X=(0,P.useState)(""),K=F()(X,2),Q=K[0],ge=K[1],M=(0,P.useState)(""),H=F()(M,2),J=H[0],se=H[1],Y=a==="0"||!a,Be=function(h){se(h)},fe=function(h){(0,x.Wi)(h).then(function(t){n.setFieldsValue({coverUrl:[Object.assign(h,{url:"https://ssl.cdn.maodouketang.com/".concat(t.key)})]})})},pe=(0,U.useRequest)(L.qm,{manual:!0}),he=pe.run,be=(0,U.useRequest)(L.No,{manual:!0}),Fe=be.run,Ee=function(){var m=c()(b()().mark(function h(t){var ve,me,ie;return b()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return ve=F()(t.coverUrl,1),me=ve[0],ie=W()(W()({},t),{},{coverUrl:me.url,courseIndex:t.courseIndex.toString()}),k.abrupt("return",(Y?(0,L.P6)(ie):(0,L.Hf)(ie)).then(function(){o.ZP.success("".concat(Y?"\u6DFB\u52A0":"\u4FEE\u6539","\u6210\u529F")),history.back()}));case 3:case"end":return k.stop()}},h)}));return function(t){return m.apply(this,arguments)}}(),ye=function(){var h=n.getFieldValue("title");w.Z.str.isEmpty(h)?o.ZP.warn("\u8BF7\u5148\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0"):C(!0)};return(0,P.useEffect)(function(){Y?he().then(function(m){return n.setFieldsValue({courseId:100+ +m+1})}):Fe(a).then(n.setFieldsValue)},[a]),(0,P.useEffect)(function(){p&&ge(n.getFieldValue("title"))},[p]),(0,r.jsxs)(te._z,{header:{title:"".concat(Y?"\u65B0\u5EFA":"\u7F16\u8F91","\u8BFE\u7A0B"),onBack:function(){return history.back()}},style:{paddingBottom:"100px"},children:[(0,r.jsxs)(de.A,{form:n,grid:!0,layout:"horizontal",labelCol:{span:4},wrapperCol:{span:12},initialValues:{web_site_name:"all"},onFinish:Ee,submitter:{render:function(h,t){return(0,r.jsx)(I.Z,{style:{marginTop:"90px"},children:(0,r.jsx)(y.Z,{span:14,offset:4,children:(0,r.jsx)(B.Z,{children:t})})})}},children:[(0,r.jsx)(G.Z,{name:"title",label:"\u8BFE\u7A0B\u540D\u79F0",colProps:{md:24,xl:24},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:x.n0}),(0,r.jsx)(G.Z,{name:"summary",label:"\u4E00\u53E5\u8BDD\u7B80\u4ECB",colProps:{md:24,xl:24},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:x.n0}),(0,r.jsxs)(z.UW,{children:[(0,r.jsx)(A.Z,{label:"\u8BFE\u7A0B\u7C7B\u578B",name:"type",labelCol:{span:12},colProps:{md:24,xl:8},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:x.n0,request:c()(b()().mark(function m(){return b()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[{value:3,label:"\u5C0F\u73ED\u8BFE(15\u4EBA\u4EE5\u4E0B)"},{value:6,label:"\u5927\u73ED\u8BFE(16\u4EBA\u4EE5\u4E0A)"}]);case 1:case"end":return t.stop()}},m)}))}),(0,r.jsx)(A.Z,{label:"\u70ED\u95E8/\u975E\u70ED\u95E8",name:"tag",labelCol:{span:12},colProps:{md:24,xl:8},required:!0,placeholder:"\u8BF7\u9009\u62E9",rules:x.n0,request:c()(b()().mark(function m(){return b()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[{value:"hot",label:"\u70ED\u95E8"},{value:"notHot",label:"\u975E\u70ED\u95E8"}]);case 1:case"end":return t.stop()}},m)}))})]}),(0,r.jsxs)(z.UW,{children:[(0,r.jsx)(G.Z,{name:"teacher",label:"\u4EFB\u8BFE\u6559\u5E08",labelCol:{span:16},colProps:{md:24,xl:6},placeholder:"\u8BF7\u8F93\u5165"}),(0,r.jsx)(A.Z,{name:"gradeLevel",label:"\u9875\u9762\u6837\u5F0F",labelCol:{span:8},colProps:{md:24,xl:6},placeholder:"\u8BF7\u9009\u62E9",required:!0,request:c()(b()().mark(function m(){return b()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[{value:1,label:"\u65B0\u8BFE\u7A0B\u9875"},{value:0,label:"\u666E\u901A\u8BFE\u7A0B\u9875"}]);case 1:case"end":return t.stop()}},m)}))}),(0,r.jsx)(A.Z,{name:"showqr",label:"\u62A5\u540D\u6743\u9650",required:!0,labelCol:{span:7},colProps:{md:24,xl:5},placeholder:"\u8BF7\u9009\u62E9",rules:x.n0,request:c()(b()().mark(function m(){return b()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[{value:0,label:"\u65E0\u6743\u9650"},{value:1,label:"\u53EA\u80FD\u8FDB\u5165\u6559\u5BA4"},{value:2,label:"\u53EA\u80FD\u89C2\u770B\u56DE\u653E"},{value:3,label:"\u6240\u6709\u6743\u9650"}]);case 1:case"end":return t.stop()}},m)}))})]}),(0,r.jsx)(ce.Z,{name:"info",label:"\u5E7F\u544A\u4F4D"}),(0,r.jsxs)(z.UW,{children:[(0,r.jsx)(j.Z,{name:"courseIndex",label:"\u6392\u5E8F",labelCol:{span:16},colProps:{md:24,xl:6},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:x.n0}),(0,r.jsx)(j.Z,{name:"oldPrice",label:"\u539F\u4EF7",labelCol:{span:8},colProps:{md:24,xl:6},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:x.n0}),(0,r.jsx)(j.Z,{name:"price",label:"\u73B0\u4EF7",labelCol:{span:4},colProps:{md:24,xl:6},required:!0,placeholder:"\u8BF7\u8F93\u5165",rules:x.n0})]}),(0,r.jsx)(ne.Z,{name:"coverUrl",label:"\u8BFE\u7A0B\u56FE\u7247",max:1,required:!0,fieldProps:{name:"file",listType:"picture-card"},rules:x.n0,action:fe,extra:"\u5EFA\u8BAE\u56FE\u7247\u6BD4\u4F8B\u4E3A16:9",accept:"image/*"}),(0,r.jsx)(le.Z,{label:"\u5E2E\u52A9",labelCol:{span:6},colProps:{md:12,xl:16},children:(0,r.jsx)(T.Z,{ghost:!0,onClick:function(){return ye()},type:"primary",children:"\u751F\u6210\u8BFE\u7A0B\u4ECB\u7ECD"})}),(0,r.jsx)(y.Z,{span:24,children:(0,r.jsx)(E.Z.Item,{label:"\u8BFE\u7A0B\u4ECB\u7ECD",name:"introduction",required:!0,rules:[{validator:function(h,t){return(0,S.isEmpty)(t.replace("<p><br></p>",""))?Promise.reject(new Error("\u8BF7\u586B\u5199\u6B64\u9879")):Promise.resolve()}}],children:(0,r.jsx)(re.Z,{height:600})})}),(0,r.jsx)(E.Z.Item,{name:"courseId",noStyle:!0}),(0,r.jsx)(E.Z.Item,{name:"id",noStyle:!0})]}),(0,r.jsx)(V.Z,{open:p,handleClose:function(){return C(!1)},prompt:"\u300A".concat(Q,"\u300B\u7684\u8BFE\u7A0B\u5927\u7EB2")})]})},s=f}}]);
